var _e=Object.defineProperty;var Be=(i,e,t)=>e in i?_e(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var y=(i,e,t)=>Be(i,typeof e!="symbol"?e+"":e,t);import{r as Ge,a as Ue,g as He}from"./react-DavUf6mE.js";import{c as Je,r as h,R as Xe}from"./zustand-YjDNudvZ.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();var ge={exports:{}},re={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ce;function Ye(){if(Ce)return re;Ce=1;var i=Ge(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(l,o,d){var u,m={},f=null,p=null;d!==void 0&&(f=""+d),o.key!==void 0&&(f=""+o.key),o.ref!==void 0&&(p=o.ref);for(u in o)r.call(o,u)&&!s.hasOwnProperty(u)&&(m[u]=o[u]);if(l&&l.defaultProps)for(u in o=l.defaultProps,o)m[u]===void 0&&(m[u]=o[u]);return{$$typeof:e,type:l,key:f,ref:p,props:m,_owner:n.current}}return re.Fragment=t,re.jsx=a,re.jsxs=a,re}var Ee;function We(){return Ee||(Ee=1,ge.exports=Ye()),ge.exports}var c=We(),ae={},Me;function qe(){if(Me)return ae;Me=1;var i=Ue();return ae.createRoot=i.createRoot,ae.hydrateRoot=i.hydrateRoot,ae}var Ve=qe();const Ke=He(Ve),se=class se{constructor(){y(this,"performanceMetrics",{lastRenderTime:0,averageRenderTime:0,renderCount:0})}static getPresetRule(e){const t=se.PRESET_RULES[e];return{birth:[...t.birth],survival:[...t.survival],notation:t.notation}}static getAllPresetRules(){return Object.entries(se.PRESET_RULES).map(([e,t])=>({id:e,name:e.charAt(0).toUpperCase()+e.slice(1),birth:[...t.birth],survival:[...t.survival],notation:t.notation}))}countNeighbors(e,t,r,n,s){let a=0;const l=t-1,o=r-1,d=n>0?-1:0,u=n<l?1:0,m=s>0?-1:0,f=s<o?1:0;for(let p=m;p<=f;p++){const v=(s+p)*t;for(let E=d;E<=u;E++)E===0&&p===0||(a+=e[v+n+E]??0)}return a}computeNextGeneration(e,t,r,n){const s=performance.now(),a=new Uint8Array(e.length),l=new Set(n.birth),o=new Set(n.survival);for(let u=0;u<r;u++){const m=u*t;for(let f=0;f<t;f++){const p=m+f,v=this.countNeighbors(e,t,r,f,u);e[p]===1?a[p]=o.has(v)?1:0:a[p]=l.has(v)?1:0}}const d=performance.now();return this.updatePerformanceMetrics(d-s),a}updatePerformanceMetrics(e){this.performanceMetrics.lastRenderTime=e,this.performanceMetrics.renderCount++;const t=.1;this.performanceMetrics.renderCount===1?this.performanceMetrics.averageRenderTime=e:this.performanceMetrics.averageRenderTime=t*e+(1-t)*this.performanceMetrics.averageRenderTime}getPerformanceMetrics(){return{...this.performanceMetrics}}resetPerformanceMetrics(){this.performanceMetrics={lastRenderTime:0,averageRenderTime:0,renderCount:0}}static validateGridBounds(e,t){return e>=20&&e<=200&&t>=20&&t<=200&&e*t<=4e4}static copyGrid(e){return new Uint8Array(e)}};y(se,"PRESET_RULES",{conway:{birth:[3],survival:[2,3],notation:"B3/S23"},highlife:{birth:[3,6],survival:[2,3],notation:"B36/S23"},seeds:{birth:[2],survival:[],notation:"B2/S"},daynight:{birth:[3,6,7,8],survival:[3,4,6,7,8],notation:"B3678/S34678"}});let de=se;var xe=(i=>(i.CANVAS_UNSUPPORTED="canvas_unsupported",i.MEMORY_EXCEEDED="memory_exceeded",i.INVALID_RULE="invalid_rule",i.PATTERN_TOO_LARGE="pattern_too_large",i.IMPORT_FAILED="import_failed",i))(xe||{});class ke{static validateRule(e){if(!e||typeof e!="string")return{valid:!1,error:"Rule notation must be a non-empty string"};const t=e.trim();if(t==="")return{valid:!1,error:"Rule notation cannot be empty"};const r=/^B([0-8]*)\/S([0-8]*)$/,n=t.match(r);if(!n)return{valid:!1,error:'Invalid format. Use B/S notation like "B3/S23" (numbers 0-8 only)'};const s=n[1]??"",a=n[2]??"";if(s.length>9)return{valid:!1,error:"Too many birth conditions (maximum 9)"};if(a.length>9)return{valid:!1,error:"Too many survival conditions (maximum 9)"};const l=s.split("").map(Number),o=a.split("").map(Number);return new Set(l).size!==l.length?{valid:!1,error:"Duplicate birth conditions not allowed"}:new Set(o).size!==o.length?{valid:!1,error:"Duplicate survival conditions not allowed"}:{valid:!0}}static parseRule(e){if(!this.validateRule(e).valid)return null;const r=e.trim().match(/^B([0-8]*)\/S([0-8]*)$/);if(!r)return null;const n=r[1]??"",s=r[2]??"";return{birth:n.split("").map(Number),survival:s.split("").map(Number),notation:e.trim()}}static formatRule(e,t){const r=[...e].sort((s,a)=>s-a),n=[...t].sort((s,a)=>s-a);return`B${r.join("")}/S${n.join("")}`}static getPresetRule(e){const t=this.PRESET_RULES[e];return{name:t.name,birth:[...t.birth],survival:[...t.survival],notation:t.notation,description:t.description}}static getAllPresetRules(){return Object.entries(this.PRESET_RULES).map(([e,t])=>({id:e,name:t.name,birth:[...t.birth],survival:[...t.survival],notation:t.notation,description:t.description}))}static isPresetRule(e){const t=e.trim();for(const[r,n]of Object.entries(this.PRESET_RULES))if(n.notation===t)return r;return null}static getPresetRuleByNotation(e){const t=this.isPresetRule(e);return t?this.getPresetRule(t):null}static validateRuleNumbers(e,t){for(const r of e)if(!Number.isInteger(r)||r<0||r>8)return{valid:!1,error:`Invalid birth condition: ${r}. Must be integer 0-8`};for(const r of t)if(!Number.isInteger(r)||r<0||r>8)return{valid:!1,error:`Invalid survival condition: ${r}. Must be integer 0-8`};return new Set(e).size!==e.length?{valid:!1,error:"Duplicate birth conditions not allowed"}:new Set(t).size!==t.length?{valid:!1,error:"Duplicate survival conditions not allowed"}:{valid:!0}}static createRule(e,t){return this.validateRuleNumbers(e,t).valid?{birth:[...e].sort((n,s)=>n-s),survival:[...t].sort((n,s)=>n-s),notation:this.formatRule(e,t)}:null}static rulesEqual(e,t){const r=[...e.birth].sort((l,o)=>l-o),n=[...t.birth].sort((l,o)=>l-o),s=[...e.survival].sort((l,o)=>l-o),a=[...t.survival].sort((l,o)=>l-o);return r.length===n.length&&s.length===a.length&&r.every((l,o)=>l===n[o])&&s.every((l,o)=>l===a[o])}}y(ke,"PRESET_RULES",{conway:{name:"Conway's Game of Life",birth:[3],survival:[2,3],notation:"B3/S23",description:"The classic cellular automaton with balanced birth and survival rules"},highlife:{name:"HighLife",birth:[3,6],survival:[2,3],notation:"B36/S23",description:"Like Conway's Life but with additional birth on 6 neighbors, creating replicators"},seeds:{name:"Seeds",birth:[2],survival:[],notation:"B2/S",description:"Every living cell dies, new cells born with 2 neighbors - creates explosive growth"},daynight:{name:"Day & Night",birth:[3,6,7,8],survival:[3,4,6,7,8],notation:"B3678/S34678",description:"Symmetric rule where both crowded and sparse areas can sustain life"}});class Z{static coordinatesToIndex(e,t,r){return t*r+e}static indexToCoordinates(e,t){return{x:e%t,y:Math.floor(e/t)}}static isValidCoordinate(e,t,r,n){return e>=0&&e<r&&t>=0&&t<n}static isValidIndex(e,t){return e>=0&&e<t}static createEmptyGrid(e,t){return new Uint8Array(e*t)}static createFilledGrid(e,t,r){const n=new Uint8Array(e*t);return r===1&&n.fill(1),n}static copyGrid(e){return new Uint8Array(e)}static clearGrid(e){e.fill(0)}static countLivingCells(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r]??0;return t}static calculateDensity(e){const t=this.countLivingCells(e);return e.length>0?t/e.length:0}static getLivingCellCoordinates(e,t){const r=[];for(let n=0;n<e.length;n++)e[n]===1&&r.push(this.indexToCoordinates(n,t));return r}static getLivingCellPositions(e,t){const r=[];for(let n=0;n<e.length;n++)if(e[n]===1){const s=this.indexToCoordinates(n,t);r.push({index:n,x:s.x,y:s.y})}return r}static gridsEqual(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}static getGridBounds(e,t,r){let n=t,s=-1,a=r,l=-1;for(let o=0;o<e.length;o++)if(e[o]===1){const d=this.indexToCoordinates(o,t);n=Math.min(n,d.x),s=Math.max(s,d.x),a=Math.min(a,d.y),l=Math.max(l,d.y)}return s===-1?null:{minX:n,maxX:s,minY:a,maxY:l}}static centerPattern(e,t,r,n){return{x:Math.floor((r-e)/2),y:Math.floor((n-t)/2)}}static canFitPattern(e,t,r,n,s,a){return r>=0&&n>=0&&r+e<=s&&n+t<=a}static getGridStatistics(e,t,r){const n=this.countLivingCells(e),s=this.calculateDensity(e),a=this.getGridBounds(e,t,r);return{totalCells:e.length,livingCells:n,deadCells:e.length-n,density:s,bounds:a,isEmpty:n===0,isFull:n===e.length}}static resizeGrid(e,t,r,n,s,a=!0){const l=this.createEmptyGrid(n,s);if(a){const o=Math.floor((n-t)/2),d=Math.floor((s-r)/2),u=Math.min(t,n),m=Math.min(r,s),f=Math.max(0,-o),p=Math.max(0,-d),v=Math.max(0,o),E=Math.max(0,d);for(let j=0;j<m-Math.abs(Math.min(0,d));j++)for(let w=0;w<u-Math.abs(Math.min(0,o));w++){const k=this.coordinatesToIndex(f+w,p+j,t),I=this.coordinatesToIndex(v+w,E+j,n);k<e.length&&I<l.length&&(l[I]=e[k]??0)}}else{const o=Math.min(t,n),d=Math.min(r,s);for(let u=0;u<d;u++)for(let m=0;m<o;m++){const f=this.coordinatesToIndex(m,u,t),p=this.coordinatesToIndex(m,u,n);l[p]=e[f]??0}}return l}}class _{static getFamousPattern(e){const t=this.FAMOUS_PATTERNS[e.toLowerCase()];return t?{...t,cells:[...t.cells]}:null}static getAllFamousPatterns(){return Object.values(this.FAMOUS_PATTERNS).map(e=>({...e,cells:[...e.cells]}))}static validatePattern(e){if(!e.name||e.name.trim()==="")return{valid:!1,error:"Pattern must have a name"};if(e.width<=0||e.height<=0)return{valid:!1,error:"Pattern dimensions must be positive"};if(e.width>200||e.height>200)return{valid:!1,error:"Pattern too large (maximum 200x200)"};for(const r of e.cells)if(r.x<0||r.x>=e.width||r.y<0||r.y>=e.height)return{valid:!1,error:`Cell at (${r.x}, ${r.y}) is outside pattern bounds`};return new Set(e.cells.map(r=>`${r.x},${r.y}`)).size!==e.cells.length?{valid:!1,error:"Pattern contains duplicate cells"}:{valid:!0}}static patternToGrid(e){const t=new Uint8Array(e.width*e.height);for(const r of e.cells){const n=Z.coordinatesToIndex(r.x,r.y,e.width);n>=0&&n<t.length&&(t[n]=1)}return t}static gridToPattern(e,t,r,n="Custom Pattern"){const s=[];for(let a=0;a<e.length;a++)if(e[a]===1){const l=Z.indexToCoordinates(a,t);s.push(l)}return{name:n,width:t,height:r,cells:s}}static placePatternOnGrid(e,t,r,n,s,a,l=!0){if(!this.validatePattern(n).valid)return{success:!1,error:xe.PATTERN_TOO_LARGE};if(!Z.canFitPattern(n.width,n.height,s,a,t,r))return{success:!1,error:xe.PATTERN_TOO_LARGE};for(const d of n.cells){const u=s+d.x,m=a+d.y;if(Z.isValidCoordinate(u,m,t,r)){const f=Z.coordinatesToIndex(u,m,t);(l||e[f]===0)&&(e[f]=1)}}return{success:!0}}static centerPatternOnGrid(e,t,r,n,s=!0){const a=Z.centerPattern(n.width,n.height,t,r);return this.placePatternOnGrid(e,t,r,n,a.x,a.y,s)}static rotatePattern(e,t){if(!this.validatePattern(e).valid)return e;let n,s=e.width,a=e.height;switch(t){case 90:s=e.height,a=e.width,n=e.cells.map(l=>({x:e.height-1-l.y,y:l.x}));break;case 180:n=e.cells.map(l=>({x:e.width-1-l.x,y:e.height-1-l.y}));break;case 270:s=e.height,a=e.width,n=e.cells.map(l=>({x:l.y,y:e.width-1-l.x}));break;default:n=[...e.cells]}return{name:`${e.name} (${t}°)`,width:s,height:a,cells:n,...e.rule&&{rule:e.rule}}}static flipPatternHorizontal(e){if(!this.validatePattern(e).valid)return e;const r=e.cells.map(n=>({x:e.width-1-n.x,y:n.y}));return{name:`${e.name} (H-flip)`,width:e.width,height:e.height,cells:r,...e.rule&&{rule:e.rule}}}static flipPatternVertical(e){if(!this.validatePattern(e).valid)return e;const r=e.cells.map(n=>({x:n.x,y:e.height-1-n.y}));return{name:`${e.name} (V-flip)`,width:e.width,height:e.height,cells:r,...e.rule&&{rule:e.rule}}}static scalePattern(e,t){if(!this.validatePattern(e).valid||t<=0)return e;const n=Math.floor(e.width*t),s=Math.floor(e.height*t);if(n>200||s>200)return e;const a=[];for(const o of e.cells)for(let d=0;d<t;d++)for(let u=0;u<t;u++){const m=Math.floor(o.x*t)+u,f=Math.floor(o.y*t)+d;m<n&&f<s&&a.push({x:m,y:f})}const l=Array.from(new Set(a.map(o=>`${o.x},${o.y}`))).map(o=>{const[d,u]=o.split(",").map(Number);return{x:d,y:u}});return{name:`${e.name} (${t}x)`,width:n,height:s,cells:l,...e.rule&&{rule:e.rule}}}static getPatternBounds(e){if(e.cells.length===0)return null;let t=e.width,r=-1,n=e.height,s=-1;for(const a of e.cells)t=Math.min(t,a.x),r=Math.max(r,a.x),n=Math.min(n,a.y),s=Math.max(s,a.y);return{minX:t,maxX:r,minY:n,maxY:s}}static normalizePattern(e){const t=this.getPatternBounds(e);if(!t)return e;const r=e.cells.map(n=>({x:n.x-t.minX,y:n.y-t.minY}));return{name:e.name,width:t.maxX-t.minX+1,height:t.maxY-t.minY+1,cells:r,...e.rule&&{rule:e.rule}}}static patternsEqual(e,t){if(e.width!==t.width||e.height!==t.height||e.cells.length!==t.cells.length)return!1;const r=new Set(e.cells.map(s=>`${s.x},${s.y}`)),n=new Set(t.cells.map(s=>`${s.x},${s.y}`));return r.size===n.size&&[...r].every(s=>n.has(s))}}y(_,"FAMOUS_PATTERNS",{glider:{name:"Glider",width:3,height:3,cells:[{x:1,y:0},{x:2,y:1},{x:0,y:2},{x:1,y:2},{x:2,y:2}],rule:"B3/S23"},blinker:{name:"Blinker",width:3,height:1,cells:[{x:0,y:0},{x:1,y:0},{x:2,y:0}],rule:"B3/S23"},block:{name:"Block",width:2,height:2,cells:[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}],rule:"B3/S23"},beacon:{name:"Beacon",width:4,height:4,cells:[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:3,y:2},{x:2,y:3},{x:3,y:3}],rule:"B3/S23"},toad:{name:"Toad",width:4,height:2,cells:[{x:1,y:0},{x:2,y:0},{x:3,y:0},{x:0,y:1},{x:1,y:1},{x:2,y:1}],rule:"B3/S23"}});class q{static import(e){if(!e||typeof e!="string")return{pattern:null,error:"Invalid RLE input"};const t=e.trim().split(/\r?\n/).filter(u=>u.trim());if(t.length===0)return{pattern:null,error:"Empty RLE input"};let r="",n=[],s=!1;for(const u of t){const m=u.trim();m.startsWith("#")||(!s&&this.HEADER_REGEX.test(m)?(r=m,s=!0):(s||this.containsRLECharacters(m))&&n.push(m))}if(!s&&n.length===0)return{pattern:null,error:"No valid RLE pattern found"};let a=0,l=0,o="B3/S23";if(r){const u=r.match(this.HEADER_REGEX);if(u&&(a=parseInt(u[1],10),l=parseInt(u[2],10),u[3])){const m=u[3].trim();ke.validateRule(m).valid&&(o=m)}}const d=n.join("").replace(/\s+/g,"");if(!this.RLE_PATTERN_REGEX.test(d))return{pattern:null,error:"Invalid RLE pattern format"};try{const u=this.parseRLEPattern(d),m=this.calculateBounds(u);return a===0&&(a=m.maxX+1),l===0&&(l=m.maxY+1),a>200||l>200?{pattern:null,error:"Pattern too large (maximum 200x200)"}:{pattern:{name:"Imported Pattern",width:a,height:l,cells:u,rule:o}}}catch(u){return{pattern:null,error:`RLE parsing error: ${u instanceof Error?u.message:"Unknown error"}`}}}static containsRLECharacters(e){return/[bo$!]/.test(e)}static parseRLEPattern(e){const t=[];let r=0,n=0,s=0;for(;s<e.length&&e[s]!=="!";){let a=1,l="";for(;s<e.length&&/\d/.test(e[s]);)l+=e[s],s++;if(l&&(a=parseInt(l,10),a<=0||a>1e3))throw new Error(`Invalid run count: ${a}`);if(s>=e.length)throw new Error("Unexpected end of pattern");const o=e[s];switch(o){case"b":r+=a;break;case"o":for(let d=0;d<a;d++)t.push({x:r+d,y:n});r+=a;break;case"$":n+=a,r=0;break;default:throw new Error(`Invalid RLE character: ${o}`)}s++}return t}static calculateBounds(e){if(e.length===0)return{minX:0,maxX:0,minY:0,maxY:0};let t=e[0].x,r=e[0].x,n=e[0].y,s=e[0].y;for(const a of e)t=Math.min(t,a.x),r=Math.max(r,a.x),n=Math.min(n,a.y),s=Math.max(s,a.y);return{minX:t,maxX:r,minY:n,maxY:s}}static exportToRLE(e){if(!e.cells||e.cells.length===0)return`x = ${e.width}, y = ${e.height}, rule = ${e.rule||"B3/S23"}
!`;const t=`x = ${e.width}, y = ${e.height}, rule = ${e.rule||"B3/S23"}`,r=new Set(e.cells.map(a=>`${a.x},${a.y}`)),n=[];for(let a=0;a<e.height;a++){let l="",o=0;for(let d=0;d<e.width;d++)r.has(`${d},${a}`)?(o>0&&(l+=o===1?"b":`${o}b`,o=0),l+="o"):o++;o>0&&a<e.height-1&&(l+=o===1?"b":`${o}b`),n.push(l)}for(;n.length>0&&n[n.length-1]==="";)n.pop();let s=n.join("$");return s?s+="!":s="!",`${t}
${s}`}}y(q,"HEADER_REGEX",/^x\s*=\s*(\d+)\s*,\s*y\s*=\s*(\d+)(?:\s*,\s*rule\s*=\s*([^\r\n]+))?/i),y(q,"RLE_PATTERN_REGEX",/^([bo$!]|\d+[bo$!])+$/);class Y{static exportToJSON(e,t,r,n,s,a="Exported Pattern"){const l=[];for(let o=0;o<e.length;o++)if(e[o]===1){const d=Math.floor(o/t),u=o%t;l.push(u,d)}return{name:a,created:new Date().toISOString(),grid:{width:t,height:r,data:l},rule:n,generation:s}}static exportJSONToFile(e){const t=JSON.stringify(e,null,2),r=new Blob([t],{type:"application/json"}),n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download=`${this.sanitizeFilename(e.name)}-${this.formatDate(e.created)}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)}static exportCanvasToPNG(e,t="grid"){try{e.toBlob(r=>{if(!r)throw new Error("Failed to create image blob");const n=URL.createObjectURL(r),s=document.createElement("a");s.href=n,s.download=`${this.sanitizeFilename(t)}-${this.formatDate(new Date().toISOString())}.png`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(n)},"image/png")}catch(r){throw console.error("PNG export failed:",r),new Error("PNG export not supported in this browser")}}static importFromJSON(e){try{const t=JSON.parse(e);if(!this.validateExportedPattern(t))return{pattern:null,error:"Invalid JSON format"};const r=[],n=t.grid.data;for(let a=0;a<n.length;a+=2){const l=n[a],o=n[a+1];l>=0&&l<t.grid.width&&o>=0&&o<t.grid.height&&r.push({x:l,y:o})}return{pattern:{name:t.name,width:t.grid.width,height:t.grid.height,cells:r,rule:t.rule}}}catch(t){return{pattern:null,error:`JSON parsing error: ${t instanceof Error?t.message:"Unknown error"}`}}}static validateExportedPattern(e){return typeof e=="object"&&e!==null&&typeof e.name=="string"&&typeof e.created=="string"&&typeof e.grid=="object"&&typeof e.grid.width=="number"&&typeof e.grid.height=="number"&&Array.isArray(e.grid.data)&&typeof e.rule=="string"&&typeof e.generation=="number"}static sanitizeFilename(e){return e.replace(/[^a-z0-9\-_]/gi,"_").replace(/_{2,}/g,"_").replace(/^_|_$/g,"").toLowerCase()}static formatDate(e){return new Date(e).toISOString().slice(0,19).replace(/[:.]/g,"-")}}class ue{static placePattern(e,t,r,n,s,a,l={}){const{overwrite:o=!0,merge:d=!1,saveState:u=!0,description:m="Pattern placement"}=l;u&&this.saveState(e,m);const f=_.validatePattern(n);if(!f.valid)return{success:!1,error:f.error||"Pattern validation failed"};if(s<0||a<0||s+n.width>t||a+n.height>r)return{success:!1,error:"Pattern extends beyond grid boundaries"};let p=0;try{for(const v of n.cells){const E=s+v.x,j=a+v.y;if(E>=0&&E<t&&j>=0&&j<r){const w=j*t+E;e[w]===0&&(e[w]=1,p++)}}return{success:!0,affectedCells:p}}catch(v){return{success:!1,error:`Placement failed: ${v instanceof Error?v.message:"Unknown error"}`}}}static centerPattern(e,t,r,n,s={}){const a=Math.floor((t-n.width)/2),l=Math.floor((r-n.height)/2),o=this.placePattern(e,t,r,n,a,l,{...s,description:`Center ${n.name}`});return o.success?{success:!0,position:{x:a,y:l}}:{success:!1,error:o.error||"Pattern placement failed"}}static canPlacePattern(e,t,r,n,s){return n>=0&&s>=0&&n+r.width<=e&&s+r.height<=t}static getPlacementPreview(e,t,r,n,s){return this.canPlacePattern(n,s,e,t,r)?e.cells.map(a=>({x:t+a.x,y:r+a.y})):[]}static clearPattern(e,t,r,n,s,a,l=!0){if(l&&this.saveState(e,`Clear ${n.name}`),!this.canPlacePattern(t,r,n,s,a))return{success:!1,error:"Pattern extends beyond grid boundaries"};let o=0;try{for(const d of n.cells){const u=s+d.x,f=(a+d.y)*t+u;e[f]===1&&(e[f]=0,o++)}return{success:!0,clearedCells:o}}catch(d){return{success:!1,error:`Clear failed: ${d instanceof Error?d.message:"Unknown error"}`}}}static saveState(e,t){const r=new Uint8Array(e.length);r.set(e),this.placementHistory.push({grid:r,timestamp:Date.now(),description:t}),this.placementHistory.length>this.MAX_HISTORY&&this.placementHistory.shift()}static undo(e){if(this.placementHistory.length===0)return{success:!1};const t=this.placementHistory.pop();return e.set(t.grid),{success:!0,description:t.description}}static canUndo(){return this.placementHistory.length>0}static getUndoDescription(){return this.placementHistory.length===0?null:this.placementHistory[this.placementHistory.length-1].description}static clearHistory(){this.placementHistory.length=0}static getBestPlacementPosition(e,t,r,n,s){const a=Math.max(0,Math.min(n-Math.floor(r.width/2),e-r.width)),l=Math.max(0,Math.min(s-Math.floor(r.height/2),t-r.height));return{x:a,y:l}}}y(ue,"placementHistory",[]),y(ue,"MAX_HISTORY",10);const Ze=200,ye=(i,e)=>new Uint8Array(i*e),Qe=()=>typeof window<"u"?window.innerWidth<768?{width:50,height:50}:{width:100,height:50}:{width:50,height:50},oe=Qe(),Pe={grid:{current:ye(oe.width,oe.height),width:oe.width,height:oe.height,generation:0},simulation:{isRunning:!1,speed:Ze,intervalId:null},rule:{birth:[3],survival:[2,3],notation:"B3/S23"},ui:{selectedPattern:null,isDrawing:!1,lastDrawnCell:null,showGrid:!0,patternPlacementMode:!1}},fe=Je((i,e)=>({...Pe,setGridSize:(t,r)=>{const n=e();n.simulation.intervalId&&clearInterval(n.simulation.intervalId),i({grid:{current:ye(t,r),width:t,height:r,generation:0},simulation:{...n.simulation,isRunning:!1,intervalId:null}})},setCell:(t,r)=>{const n=e(),s=new Uint8Array(n.grid.current);s[t]=r,i({grid:{...n.grid,current:s}})},toggleCell:t=>{const n=e().grid.current[t];e().setCell(t,n===1?0:1)},clearGrid:()=>{const t=e(),{width:r,height:n}=t.grid;i({grid:{...t.grid,current:ye(r,n),generation:0}})},randomizeGrid:()=>{const t=e(),{width:r,height:n}=t.grid,s=r*n,a=new Uint8Array(s);for(let l=0;l<s;l++)a[l]=Math.random()>.5?1:0;i({grid:{...t.grid,current:a,generation:0}})},setRule:t=>{i(()=>({rule:{...t}}))},setSpeed:t=>{const r=e(),n=r.simulation.isRunning;if(n&&r.simulation.intervalId&&clearInterval(r.simulation.intervalId),i({simulation:{...r.simulation,speed:t,intervalId:null,isRunning:!1}}),n){const s=window.setInterval(()=>{e().stepSimulation()},t);i(a=>({simulation:{...a.simulation,isRunning:!0,intervalId:s}}))}},startSimulation:()=>{const t=e();if(t.simulation.isRunning)return;const r=window.setInterval(()=>{e().stepSimulation()},t.simulation.speed);i({simulation:{...t.simulation,isRunning:!0,intervalId:r}})},stopSimulation:()=>{const t=e();t.simulation.intervalId&&clearInterval(t.simulation.intervalId),i({simulation:{...t.simulation,isRunning:!1,intervalId:null}})},stepSimulation:()=>{const t=e(),{current:r,width:n,height:s,generation:a}=t.grid,{rule:l}=t,d=new de().computeNextGeneration(r,n,s,l);i({grid:{...t.grid,current:d,generation:a+1}})},incrementGeneration:()=>{i(t=>({grid:{...t.grid,generation:t.grid.generation+1}}))},setSelectedPattern:t=>{i(r=>({ui:{...r.ui,selectedPattern:t}}))},setIsDrawing:t=>{i(r=>({ui:{...r.ui,isDrawing:t}}))},setLastDrawnCell:t=>{i(r=>({ui:{...r.ui,lastDrawnCell:t}}))},toggleGridLines:()=>{i(t=>({ui:{...t.ui,showGrid:!t.ui.showGrid}}))},resetState:()=>{const t=e();t.simulation.intervalId!==null&&clearInterval(t.simulation.intervalId),i({...Pe})},placePattern:(t,r,n)=>{const s=e(),a=new Uint8Array(s.grid.current),l=ue.placePattern(a,s.grid.width,s.grid.height,t,r,n,{saveState:!1});return l.success?(i({grid:{...s.grid,current:a}}),{success:!0}):{success:!1,error:l.error}},centerPattern:t=>{const r=e(),n=new Uint8Array(r.grid.current),s=ue.centerPattern(n,r.grid.width,r.grid.height,t,{saveState:!1});return s.success?(i({grid:{...r.grid,current:n}}),{success:!0,position:s.position}):{success:!1,error:s.error}},setPatternPlacementMode:(t,r)=>{i(n=>({ui:{...n.ui,patternPlacementMode:t,selectedPattern:r?.name||null}}))}}));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),tt=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),Te=i=>{const e=tt(i);return e.charAt(0).toUpperCase()+e.slice(1)},Ne=(...i)=>i.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),rt=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var nt={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=h.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:n="",children:s,iconNode:a,...l},o)=>h.createElement("svg",{ref:o,...nt,width:e,height:e,stroke:i,strokeWidth:r?Number(t)*24/Number(e):t,className:Ne("lucide",n),...!s&&!rt(l)&&{"aria-hidden":"true"},...l},[...a.map(([d,u])=>h.createElement(d,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=(i,e)=>{const t=h.forwardRef(({className:r,...n},s)=>h.createElement(st,{ref:s,iconNode:e,className:Ne(`lucide-${et(Te(i))}`,`lucide-${i}`,r),...n}));return t.displayName=Te(i),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],at=Q("pause",it);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],lt=Q("play",ot);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],dt=Q("rotate-ccw",ct);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ht=Q("settings",ut);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],ft=Q("shuffle",mt);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]],gt=Q("skip-forward",pt);let xt={data:""},yt=i=>typeof window=="object"?((i?i.querySelector("#_goober"):window._goober)||Object.assign((i||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:i||xt,bt=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,vt=/\/\*[^]*?\*\/|  +/g,je=/\n+/g,G=(i,e)=>{let t="",r="",n="";for(let s in i){let a=i[s];s[0]=="@"?s[1]=="i"?t=s+" "+a+";":r+=s[1]=="f"?G(a,s):s+"{"+G(a,s[1]=="k"?"":e)+"}":typeof a=="object"?r+=G(a,e?e.replace(/([^,])+/g,l=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,o=>/&/.test(o)?o.replace(/&/g,l):l?l+" "+o:o)):s):a!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),n+=G.p?G.p(s,a):s+":"+a+";")}return t+(e&&n?e+"{"+n+"}":n)+r},z={},Ie=i=>{if(typeof i=="object"){let e="";for(let t in i)e+=t+Ie(i[t]);return e}return i},wt=(i,e,t,r,n)=>{let s=Ie(i),a=z[s]||(z[s]=(o=>{let d=0,u=11;for(;d<o.length;)u=101*u+o.charCodeAt(d++)>>>0;return"go"+u})(s));if(!z[a]){let o=s!==i?i:(d=>{let u,m,f=[{}];for(;u=bt.exec(d.replace(vt,""));)u[4]?f.shift():u[3]?(m=u[3].replace(je," ").trim(),f.unshift(f[0][m]=f[0][m]||{})):f[0][u[1]]=u[2].replace(je," ").trim();return f[0]})(i);z[a]=G(n?{["@keyframes "+a]:o}:o,t?"":"."+a)}let l=t&&z.g?z.g:null;return t&&(z.g=z[a]),((o,d,u,m)=>{m?d.data=d.data.replace(m,o):d.data.indexOf(o)===-1&&(d.data=u?o+d.data:d.data+o)})(z[a],e,r,l),a},St=(i,e,t)=>i.reduce((r,n,s)=>{let a=e[s];if(a&&a.call){let l=a(t),o=l&&l.props&&l.props.className||/^go/.test(l)&&l;a=o?"."+o:l&&typeof l=="object"?l.props?"":G(l,""):l===!1?"":l}return r+n+(a??"")},"");function pe(i){let e=this||{},t=i.call?i(e.p):i;return wt(t.unshift?t.raw?St(t,[].slice.call(arguments,1),e.p):t.reduce((r,n)=>Object.assign(r,n&&n.call?n(e.p):n),{}):t,yt(e.target),e.g,e.o,e.k)}let Le,be,ve;pe.bind({g:1});let B=pe.bind({k:1});function Rt(i,e,t,r){G.p=e,Le=i,be=t,ve=r}function U(i,e){let t=this||{};return function(){let r=arguments;function n(s,a){let l=Object.assign({},s),o=l.className||n.className;t.p=Object.assign({theme:be&&be()},l),t.o=/ *go\d+/.test(o),l.className=pe.apply(t,r)+(o?" "+o:"");let d=i;return i[0]&&(d=l.as||i,delete l.as),ve&&d[0]&&ve(l),Le(d,l)}return n}}var Ct=i=>typeof i=="function",he=(i,e)=>Ct(i)?i(e):i,Et=(()=>{let i=0;return()=>(++i).toString()})(),$e=(()=>{let i;return()=>{if(i===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");i=!e||e.matches}return i}})(),Mt=20,Ae=(i,e)=>{switch(e.type){case 0:return{...i,toasts:[e.toast,...i.toasts].slice(0,Mt)};case 1:return{...i,toasts:i.toasts.map(s=>s.id===e.toast.id?{...s,...e.toast}:s)};case 2:let{toast:t}=e;return Ae(i,{type:i.toasts.find(s=>s.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=e;return{...i,toasts:i.toasts.map(s=>s.id===r||r===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return e.toastId===void 0?{...i,toasts:[]}:{...i,toasts:i.toasts.filter(s=>s.id!==e.toastId)};case 5:return{...i,pausedAt:e.time};case 6:let n=e.time-(i.pausedAt||0);return{...i,pausedAt:void 0,toasts:i.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+n}))}}},ce=[],W={toasts:[],pausedAt:void 0},V=i=>{W=Ae(W,i),ce.forEach(e=>{e(W)})},Pt={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Tt=(i={})=>{let[e,t]=h.useState(W),r=h.useRef(W);h.useEffect(()=>(r.current!==W&&t(W),ce.push(t),()=>{let s=ce.indexOf(t);s>-1&&ce.splice(s,1)}),[]);let n=e.toasts.map(s=>{var a,l,o;return{...i,...i[s.type],...s,removeDelay:s.removeDelay||((a=i[s.type])==null?void 0:a.removeDelay)||i?.removeDelay,duration:s.duration||((l=i[s.type])==null?void 0:l.duration)||i?.duration||Pt[s.type],style:{...i.style,...(o=i[s.type])==null?void 0:o.style,...s.style}}});return{...e,toasts:n}},jt=(i,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:i,pauseDuration:0,...t,id:t?.id||Et()}),ie=i=>(e,t)=>{let r=jt(e,i,t);return V({type:2,toast:r}),r.id},L=(i,e)=>ie("blank")(i,e);L.error=ie("error");L.success=ie("success");L.loading=ie("loading");L.custom=ie("custom");L.dismiss=i=>{V({type:3,toastId:i})};L.remove=i=>V({type:4,toastId:i});L.promise=(i,e,t)=>{let r=L.loading(e.loading,{...t,...t?.loading});return typeof i=="function"&&(i=i()),i.then(n=>{let s=e.success?he(e.success,n):void 0;return s?L.success(s,{id:r,...t,...t?.success}):L.dismiss(r),n}).catch(n=>{let s=e.error?he(e.error,n):void 0;s?L.error(s,{id:r,...t,...t?.error}):L.dismiss(r)}),i};var kt=(i,e)=>{V({type:1,toast:{id:i,height:e}})},Nt=()=>{V({type:5,time:Date.now()})},ne=new Map,It=1e3,Lt=(i,e=It)=>{if(ne.has(i))return;let t=setTimeout(()=>{ne.delete(i),V({type:4,toastId:i})},e);ne.set(i,t)},$t=i=>{let{toasts:e,pausedAt:t}=Tt(i);h.useEffect(()=>{if(t)return;let s=Date.now(),a=e.map(l=>{if(l.duration===1/0)return;let o=(l.duration||0)+l.pauseDuration-(s-l.createdAt);if(o<0){l.visible&&L.dismiss(l.id);return}return setTimeout(()=>L.dismiss(l.id),o)});return()=>{a.forEach(l=>l&&clearTimeout(l))}},[e,t]);let r=h.useCallback(()=>{t&&V({type:6,time:Date.now()})},[t]),n=h.useCallback((s,a)=>{let{reverseOrder:l=!1,gutter:o=8,defaultPosition:d}=a||{},u=e.filter(p=>(p.position||d)===(s.position||d)&&p.height),m=u.findIndex(p=>p.id===s.id),f=u.filter((p,v)=>v<m&&p.visible).length;return u.filter(p=>p.visible).slice(...l?[f+1]:[0,f]).reduce((p,v)=>p+(v.height||0)+o,0)},[e]);return h.useEffect(()=>{e.forEach(s=>{if(s.dismissed)Lt(s.id,s.removeDelay);else{let a=ne.get(s.id);a&&(clearTimeout(a),ne.delete(s.id))}})},[e]),{toasts:e,handlers:{updateHeight:kt,startPause:Nt,endPause:r,calculateOffset:n}}},At=B`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Dt=B`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ft=B`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,zt=U("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${At} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Dt} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${i=>i.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Ft} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Ot=B`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,_t=U("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${i=>i.secondary||"#e0e0e0"};
  border-right-color: ${i=>i.primary||"#616161"};
  animation: ${Ot} 1s linear infinite;
`,Bt=B`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Gt=B`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Ut=U("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${i=>i.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Bt} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Gt} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${i=>i.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Ht=U("div")`
  position: absolute;
`,Jt=U("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Xt=B`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Yt=U("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Xt} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Wt=({toast:i})=>{let{icon:e,type:t,iconTheme:r}=i;return e!==void 0?typeof e=="string"?h.createElement(Yt,null,e):e:t==="blank"?null:h.createElement(Jt,null,h.createElement(_t,{...r}),t!=="loading"&&h.createElement(Ht,null,t==="error"?h.createElement(zt,{...r}):h.createElement(Ut,{...r})))},qt=i=>`
0% {transform: translate3d(0,${i*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Vt=i=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${i*-150}%,-1px) scale(.6); opacity:0;}
`,Kt="0%{opacity:0;} 100%{opacity:1;}",Zt="0%{opacity:1;} 100%{opacity:0;}",Qt=U("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,er=U("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,tr=(i,e)=>{let t=i.includes("top")?1:-1,[r,n]=$e()?[Kt,Zt]:[qt(t),Vt(t)];return{animation:e?`${B(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${B(n)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},rr=h.memo(({toast:i,position:e,style:t,children:r})=>{let n=i.height?tr(i.position||e||"top-center",i.visible):{opacity:0},s=h.createElement(Wt,{toast:i}),a=h.createElement(er,{...i.ariaProps},he(i.message,i));return h.createElement(Qt,{className:i.className,style:{...n,...t,...i.style}},typeof r=="function"?r({icon:s,message:a}):h.createElement(h.Fragment,null,s,a))});Rt(h.createElement);var nr=({id:i,className:e,style:t,onHeightUpdate:r,children:n})=>{let s=h.useCallback(a=>{if(a){let l=()=>{let o=a.getBoundingClientRect().height;r(i,o)};l(),new MutationObserver(l).observe(a,{subtree:!0,childList:!0,characterData:!0})}},[i,r]);return h.createElement("div",{ref:s,className:e,style:t},n)},sr=(i,e)=>{let t=i.includes("top"),r=t?{top:0}:{bottom:0},n=i.includes("center")?{justifyContent:"center"}:i.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:$e()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...n}},ir=pe`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,le=16,ar=({reverseOrder:i,position:e="top-center",toastOptions:t,gutter:r,children:n,containerStyle:s,containerClassName:a})=>{let{toasts:l,handlers:o}=$t(t);return h.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:le,left:le,right:le,bottom:le,pointerEvents:"none",...s},className:a,onMouseEnter:o.startPause,onMouseLeave:o.endPause},l.map(d=>{let u=d.position||e,m=o.calculateOffset(d,{reverseOrder:i,gutter:r,defaultPosition:e}),f=sr(u,m);return h.createElement(nr,{id:d.id,key:d.id,onHeightUpdate:o.updateHeight,className:d.visible?ir:"",style:f},d.type==="custom"?he(d.message,d):n?n(d):h.createElement(rr,{toast:d,position:u}))}))},F=L;class or{constructor(e){y(this,"canvas");y(this,"ctx");y(this,"devicePixelRatio");y(this,"lastFrameTime",0);y(this,"frameCount",0);y(this,"fps",0);this.canvas=e;const t=e.getContext("2d");if(!t)throw new Error("Canvas 2D context not supported");this.ctx=t,this.devicePixelRatio=window.devicePixelRatio||1,this.setupCanvas()}setupCanvas(){const{canvas:e,ctx:t,devicePixelRatio:r}=this,n=e.getBoundingClientRect();e.width=n.width*r,e.height=n.height*r,t.scale(r,r),e.style.width=`${n.width}px`,e.style.height=`${n.height}px`,t.imageSmoothingEnabled=!1}resize(){this.setupCanvas()}render(e,t,r,n={showGrid:!1}){const s=performance.now(),{canvas:a,ctx:l}=this,o=a.getBoundingClientRect(),d=Math.min(o.width/t,o.height/r);l.fillStyle="#1a1a2a",l.fillRect(0,0,o.width,o.height),l.fillStyle="#00d4ff";for(let u=0;u<e.length;u++)if(e[u]===1){const m=u%t*d,f=Math.floor(u/t)*d;l.fillRect(m,f,d,d)}n.showGrid&&t<=50&&this.renderGridLines(t,r,d),this.updateFPS(s)}renderGridLines(e,t,r){const{ctx:n}=this;n.strokeStyle="#333344",n.lineWidth=1,n.beginPath();for(let s=0;s<=e;s++){const a=s*r;n.moveTo(a,0),n.lineTo(a,t*r)}for(let s=0;s<=t;s++){const a=s*r;n.moveTo(0,a),n.lineTo(e*r,a)}n.stroke()}updateFPS(e){const t=performance.now(),r=t-e;t-this.lastFrameTime>=1e3&&(this.fps=this.frameCount,this.frameCount=0,this.lastFrameTime=t,r>16.67&&console.warn(`Slow render: ${r.toFixed(2)}ms (target: <16.67ms)`)),this.frameCount++}getFPS(){return this.fps}getCellSize(e,t){const r=this.canvas.getBoundingClientRect();return Math.min(r.width/e,r.height/t)}coordinateToCell(e,t,r,n){const s=this.canvas.getBoundingClientRect(),a=this.getCellSize(r,n),l=Math.floor((e-s.left)/a),o=Math.floor((t-s.top)/a);return l>=0&&l<r&&o>=0&&o<n?{x:l,y:o,index:o*r+l}:null}}class lr{constructor(e,t,r,n,s){y(this,"isDrawing",!1);y(this,"lastCell",null);y(this,"canvas");y(this,"onCellChange");y(this,"onDrawingStateChange");y(this,"onLastCellChange");y(this,"getCurrentGrid");y(this,"handleMouseDown",e=>{e.preventDefault(),this.startDrawing(),this.handleCellInteraction(e.clientX,e.clientY)});y(this,"handleMouseMove",e=>{this.isDrawing&&(e.preventDefault(),this.handleCellInteraction(e.clientX,e.clientY))});y(this,"handleMouseUp",e=>{this.stopDrawing()});y(this,"handleMouseLeave",e=>{this.stopDrawing()});y(this,"handleTouchStart",e=>{if(e.preventDefault(),e.touches.length!==1)return;const t=e.touches[0];t&&(this.startDrawing(),this.handleCellInteraction(t.clientX,t.clientY))});y(this,"handleTouchMove",e=>{if(e.preventDefault(),!this.isDrawing||e.touches.length!==1)return;const t=e.touches[0];t&&this.handleCellInteraction(t.clientX,t.clientY)});y(this,"handleTouchEnd",e=>{e.preventDefault(),this.stopDrawing()});this.canvas=e,this.onCellChange=t,this.onDrawingStateChange=r,this.onLastCellChange=n,this.getCurrentGrid=s,this.setupEventListeners()}setupEventListeners(){this.canvas.addEventListener("mousedown",this.handleMouseDown),this.canvas.addEventListener("mousemove",this.handleMouseMove),this.canvas.addEventListener("mouseup",this.handleMouseUp),this.canvas.addEventListener("mouseleave",this.handleMouseLeave),this.canvas.addEventListener("touchstart",this.handleTouchStart,{passive:!1}),this.canvas.addEventListener("touchmove",this.handleTouchMove,{passive:!1}),this.canvas.addEventListener("touchend",this.handleTouchEnd,{passive:!1}),this.canvas.addEventListener("touchcancel",this.handleTouchEnd,{passive:!1})}startDrawing(){this.isDrawing=!0,this.onDrawingStateChange(!0)}stopDrawing(){this.isDrawing=!1,this.lastCell=null,this.onDrawingStateChange(!1),this.onLastCellChange(null)}handleCellInteraction(e,t){const r=this.getTouch(e,t);if(!r||r.cellIndex===null||r.cellIndex===this.lastCell)return;this.lastCell=r.cellIndex,this.onLastCellChange(r.cellIndex);const s=this.getCurrentGridState()[r.cellIndex];this.onCellChange(r.cellIndex,s===1?0:1)}getTouch(e,t){const r=this.canvas.getBoundingClientRect(),n=e-r.left,s=t-r.top;return{x:n,y:s,cellIndex:this.getCellIndex(n,s)}}getCellIndex(e,t){const{width:r,height:n}=this.getGridDimensions(),s=this.getCellSize(),a=Math.floor(e/s),l=Math.floor(t/s);return a>=0&&a<r&&l>=0&&l<n?l*r+a:null}getCellSize(){const{width:e,height:t}=this.getGridDimensions(),r=this.canvas.getBoundingClientRect();return Math.min(r.width/e,r.height/t)}getGridDimensions(){const e=this.canvas;return{width:parseInt(e.dataset.gridWidth||"50"),height:parseInt(e.dataset.gridHeight||"50")}}getCurrentGridState(){return this.getCurrentGrid()}destroy(){this.canvas.removeEventListener("mousedown",this.handleMouseDown),this.canvas.removeEventListener("mousemove",this.handleMouseMove),this.canvas.removeEventListener("mouseup",this.handleMouseUp),this.canvas.removeEventListener("mouseleave",this.handleMouseLeave),this.canvas.removeEventListener("touchstart",this.handleTouchStart),this.canvas.removeEventListener("touchmove",this.handleTouchMove),this.canvas.removeEventListener("touchend",this.handleTouchEnd),this.canvas.removeEventListener("touchcancel",this.handleTouchEnd)}}class cr{constructor(e){y(this,"frameCount",0);y(this,"frameTimeSum",0);y(this,"renderCount",0);y(this,"fps",0);y(this,"lastFPSUpdate",0);y(this,"frameTimes",[]);y(this,"maxFrameTimes",60);y(this,"targetFrameTime",16.67);y(this,"onWarning");this.onWarning=e}startFrame(){return performance.now()}endFrame(e){const t=performance.now(),r=t-e;if(this.frameCount++,this.renderCount++,this.frameTimeSum+=r,this.frameTimes.push(r),this.frameTimes.length>this.maxFrameTimes&&this.frameTimes.shift(),t-this.lastFPSUpdate>=1e3&&(this.fps=this.frameCount,this.frameCount=0,this.lastFPSUpdate=t),r>this.targetFrameTime){const n=this.getMetrics();this.onWarning?.(`Frame time ${r.toFixed(2)}ms exceeds target ${this.targetFrameTime}ms`,n)}}getMetrics(){const e=this.frameTimeSum/Math.max(this.renderCount,1);return{fps:this.fps,frameTime:this.frameTimes[this.frameTimes.length-1]||0,memoryUsage:this.getMemoryUsage(),renderCount:this.renderCount,averageFrameTime:e}}getMemoryUsage(){return"memory"in performance?performance.memory.usedJSHeapSize/1024/1024:0}reset(){this.frameCount=0,this.frameTimeSum=0,this.renderCount=0,this.frameTimes=[],this.lastFPSUpdate=0}isPerformanceGood(){const e=this.getMetrics();return e.fps>=55&&e.averageFrameTime<=this.targetFrameTime*1.2}getPerformanceGrade(){const e=this.getMetrics();return e.fps>=58&&e.averageFrameTime<=this.targetFrameTime?"excellent":e.fps>=50&&e.averageFrameTime<=this.targetFrameTime*1.5?"good":e.fps>=30&&e.averageFrameTime<=this.targetFrameTime*2?"fair":"poor"}createReportString(){const e=this.getMetrics();return[`Performance: ${this.getPerformanceGrade().toUpperCase()}`,`FPS: ${e.fps}`,`Frame Time: ${e.frameTime.toFixed(2)}ms (avg: ${e.averageFrameTime.toFixed(2)}ms)`,`Memory: ${e.memoryUsage.toFixed(1)}MB`,`Renders: ${e.renderCount}`].join(" | ")}}const De=h.memo(({width:i=400,height:e=400,className:t="",onPerformanceUpdate:r,canvasRef:n})=>{const s=h.useRef(null),a=n||s,l=h.useRef(null),o=h.useRef(null),d=h.useRef(null),u=h.useRef(null),{grid:m,ui:f,setCell:p,setIsDrawing:v,setLastDrawnCell:E}=fe(),j=h.useCallback((S,R)=>{console.warn(`GridCanvas Performance Warning: ${S}`,R),r?.(R)},[r]),w=h.useCallback(()=>{if(a.current)try{l.current=new or(a.current),d.current=new cr(j)}catch(S){console.error("Failed to initialize GridRenderer:",S)}},[j]),k=h.useCallback(()=>{if(!a.current||!l.current)return;const S=(x,P)=>{p(x,P)},R=x=>{v(x)},N=x=>{E(x)},g=()=>m.current;o.current=new lr(a.current,S,R,N,g)},[p,v,E,m]),I=h.useCallback(()=>{if(!l.current||!d.current)return;const S=d.current.startFrame();l.current.render(m.current,m.width,m.height,{showGrid:f.showGrid}),d.current.endFrame(S);const R=d.current.getMetrics();r?.(R)},[m,f.showGrid,r]),M=h.useCallback(()=>{u.current&&cancelAnimationFrame(u.current),u.current=requestAnimationFrame(I)},[I]);return h.useEffect(()=>(w(),()=>{u.current&&cancelAnimationFrame(u.current)}),[w]),h.useEffect(()=>(k(),()=>{o.current?.destroy()}),[k]),h.useEffect(()=>{M()},[M]),h.useEffect(()=>{const S=()=>{l.current?.resize(),M()};return window.addEventListener("resize",S),()=>window.removeEventListener("resize",S)},[M]),h.useEffect(()=>{a.current&&(a.current.dataset.gridWidth=m.width.toString(),a.current.dataset.gridHeight=m.height.toString())},[m.width,m.height]),c.jsx("canvas",{ref:a,width:i,height:e,className:`border border-grid-line cursor-pointer touch-none ${t}`,style:{width:`${i}px`,height:`${e}px`,maxWidth:"100%",maxHeight:"100%"},"aria-label":`Cellular automata grid, ${m.width} by ${m.height} cells, generation ${m.generation}`,role:"img"})});De.displayName="GridCanvas";const dr=({className:i="",canvasRef:e})=>{const{grid:t}=fe(),r=h.useMemo(()=>{const n=t.width/t.height,s=Math.min(window.innerWidth*.9,window.innerHeight*.8,800);let a,l;return n>1?(a=s,l=s/n):(l=s,a=s*n),{width:Math.max(400,Math.min(a,1200)),height:Math.max(400,Math.min(l,1200))}},[t.width,t.height]);return c.jsxs("div",{className:`flex flex-col items-center ${i}`,children:[c.jsx("div",{className:"relative",children:c.jsx(De,{width:r.width,height:r.height,className:"rounded-lg shadow-lg",canvasRef:e})}),c.jsxs("div",{className:"mt-4 text-center text-lg text-text-secondary",children:[c.jsxs("div",{children:["Grid Size: ",t.width," × ",t.height," cells"]}),c.jsxs("div",{children:["Generation: ",t.generation]})]})]})},me=({pattern:i,size:e=64,selected:t=!1,onClick:r,className:n=""})=>{const s=h.useRef(null),[a,l]=h.useState(!1);return h.useEffect(()=>{const o=s.current;if(!o)return;const d=o.getContext("2d");if(!d)return;o.width=e,o.height=e,d.fillStyle="#0a0a0f",d.fillRect(0,0,e,e);const u=Math.min(Math.floor(e/Math.max(i.width,i.height))-1,8);if(u<1)return;const m=Math.floor((e-i.width*u)/2),f=Math.floor((e-i.height*u)/2);d.fillStyle="#00d4ff";for(const p of i.cells){const v=m+p.x*u,E=f+p.y*u;d.fillRect(v,E,u-1,u-1)}(t||a)&&(d.strokeStyle=t?"#00d4ff":"#666",d.lineWidth=t?2:1,d.strokeRect(0,0,e,e))},[i,e,t,a]),c.jsxs("div",{className:`pattern-preview ${n} ${t?"selected":""}`,onClick:r,onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"8px",borderRadius:"8px",backgroundColor:t?"#1a1a2a":"transparent",cursor:r?"pointer":"default",transition:"background-color 0.2s",minWidth:`${e+16}px`},children:[c.jsx("canvas",{ref:s,width:e,height:e,style:{display:"block",borderRadius:"4px",marginBottom:"4px"}}),c.jsx("span",{style:{fontSize:"12px",color:"#ccc",textAlign:"center",wordBreak:"break-word",maxWidth:`${e+16}px`},children:i.name})]})},ur=({onImport:i,onClose:e,className:t=""})=>{const[r,n]=h.useState(""),[s,a]=h.useState(""),[l,o]=h.useState("rle"),[d,u]=h.useState(null),[m,f]=h.useState(""),[p,v]=h.useState(!1),E=h.useRef(null),j=()=>{if(!r.trim()){f("Please enter RLE text");return}v(!0),f("");try{const S=q.import(r);S.pattern?(u(S.pattern),f("")):(f(S.error||"Failed to import RLE pattern"),u(null))}catch(S){f(`Import failed: ${S instanceof Error?S.message:"Unknown error"}`),u(null)}finally{v(!1)}},w=()=>{if(!s.trim()){f("Please enter JSON text");return}v(!0),f("");try{const S=Y.importFromJSON(s);S.pattern?(u(S.pattern),f("")):(f(S.error||"Failed to import JSON pattern"),u(null))}catch(S){f(`Import failed: ${S instanceof Error?S.message:"Unknown error"}`),u(null)}finally{v(!1)}},k=S=>{const R=S.target.files?.[0];if(!R)return;v(!0),f("");const N=new FileReader;N.onload=g=>{const x=g.target?.result;if(!x){f("Failed to read file"),v(!1);return}try{let P;R.name.toLowerCase().endsWith(".rle")?P=q.import(x):R.name.toLowerCase().endsWith(".json")?P=Y.importFromJSON(x):(P=q.import(x),P.pattern||(P=Y.importFromJSON(x))),P.pattern?(u(P.pattern),f("")):(f(P.error||"Failed to import file"),u(null))}catch(P){f(`Import failed: ${P instanceof Error?P.message:"Unknown error"}`),u(null)}finally{v(!1)}},N.onerror=()=>{f("Failed to read file"),v(!1)},N.readAsText(R)},I=()=>{d&&(i(d),e())},M=()=>{n(""),a(""),u(null),f(""),E.current&&(E.current.value="")};return c.jsxs("div",{className:`pattern-import ${t}`,style:{display:"flex",flexDirection:"column",gap:"16px",padding:"20px",backgroundColor:"#1a1a2a",borderRadius:"12px",border:"1px solid #333344",maxWidth:"600px",width:"100%"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px"},children:"Import Pattern"}),c.jsx("button",{onClick:e,style:{background:"none",border:"none",color:"#ccc",fontSize:"18px",cursor:"pointer",padding:"4px 8px"},children:"×"})]}),c.jsx("div",{style:{display:"flex",gap:"8px",marginBottom:"12px"},children:["rle","json","file"].map(S=>c.jsx("button",{onClick:()=>o(S),style:{padding:"8px 16px",border:"1px solid #333344",borderRadius:"6px",backgroundColor:l===S?"#00d4ff":"#2a2a3a",color:l===S?"#000":"#ccc",cursor:"pointer",fontSize:"14px",textTransform:"uppercase"},children:S},S))}),l==="rle"&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[c.jsx("label",{style:{color:"#ccc",fontSize:"14px"},children:'RLE Pattern (e.g. "x = 3, y = 3, rule = B3/S23\\nbo$2bo$3o!")'}),c.jsx("textarea",{value:r,onChange:S=>n(S.target.value),placeholder:"Enter RLE pattern...",style:{minHeight:"120px",padding:"12px",borderRadius:"6px",border:"1px solid #333344",backgroundColor:"#2a2a3a",color:"#fff",fontSize:"14px",fontFamily:"monospace",resize:"vertical"}}),c.jsx("button",{onClick:j,disabled:p||!r.trim(),style:{padding:"10px 20px",borderRadius:"6px",border:"none",backgroundColor:p||!r.trim()?"#444":"#00d4ff",color:p||!r.trim()?"#888":"#000",cursor:p||!r.trim()?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:p?"Processing...":"Import RLE"})]}),l==="json"&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[c.jsx("label",{style:{color:"#ccc",fontSize:"14px"},children:"JSON Pattern (exported from CellularLab)"}),c.jsx("textarea",{value:s,onChange:S=>a(S.target.value),placeholder:"Paste JSON pattern...",style:{minHeight:"120px",padding:"12px",borderRadius:"6px",border:"1px solid #333344",backgroundColor:"#2a2a3a",color:"#fff",fontSize:"14px",fontFamily:"monospace",resize:"vertical"}}),c.jsx("button",{onClick:w,disabled:p||!s.trim(),style:{padding:"10px 20px",borderRadius:"6px",border:"none",backgroundColor:p||!s.trim()?"#444":"#00d4ff",color:p||!s.trim()?"#888":"#000",cursor:p||!s.trim()?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:p?"Processing...":"Import JSON"})]}),l==="file"&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[c.jsx("label",{style:{color:"#ccc",fontSize:"14px"},children:"Upload File (.rle, .json, or .txt)"}),c.jsx("input",{ref:E,type:"file",accept:".rle,.json,.txt",onChange:k,style:{padding:"12px",borderRadius:"6px",border:"1px solid #333344",backgroundColor:"#2a2a3a",color:"#ccc",fontSize:"14px"}})]}),m&&c.jsx("div",{style:{padding:"12px",borderRadius:"6px",backgroundColor:"#4a1a1a",border:"1px solid #aa3333",color:"#ffaaaa",fontSize:"14px"},children:m}),d&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",padding:"16px",borderRadius:"6px",backgroundColor:"#2a2a3a",border:"1px solid #333344"},children:[c.jsx("div",{style:{color:"#ccc",fontSize:"14px",fontWeight:"bold"},children:"Preview:"}),c.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"16px"},children:[c.jsx(me,{pattern:d,size:80}),c.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:[c.jsx("div",{children:c.jsx("strong",{children:d.name})}),c.jsxs("div",{children:["Size: ",d.width," × ",d.height]}),c.jsxs("div",{children:["Cells: ",d.cells.length]}),d.rule&&c.jsxs("div",{children:["Rule: ",d.rule]})]})]}),c.jsxs("div",{style:{display:"flex",gap:"8px"},children:[c.jsx("button",{onClick:I,style:{padding:"10px 20px",borderRadius:"6px",border:"none",backgroundColor:"#00d4ff",color:"#000",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:"Import Pattern"}),c.jsx("button",{onClick:M,style:{padding:"10px 20px",borderRadius:"6px",border:"1px solid #666",backgroundColor:"transparent",color:"#ccc",cursor:"pointer",fontSize:"14px"},children:"Clear"})]})]})]})},hr=({grid:i,gridWidth:e,gridHeight:t,rule:r,generation:n,canvasRef:s,onClose:a,className:l=""})=>{const[o,d]=h.useState("json"),[u,m]=h.useState("Custom Pattern"),[f,p]=h.useState(!1),[v,E]=h.useState(""),[j,w]=h.useState(""),k=_.gridToPattern(i,e,t,u);k.rule=r;const I=async()=>{if(!u.trim()){w("Please enter a pattern name");return}p(!0),w(""),E("");try{switch(o){case"json":{const x=Y.exportToJSON(i,e,t,r,n,u);Y.exportJSONToFile(x),E("JSON file downloaded successfully!");break}case"rle":{const x=q.exportToRLE(k),P=new Blob([x],{type:"text/plain"}),A=URL.createObjectURL(P),D=document.createElement("a");D.href=A,D.download=`${u.replace(/[^a-z0-9\-_]/gi,"_").toLowerCase()}.rle`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(A),E("RLE file downloaded successfully!");break}case"png":{if(!s?.current){w("Canvas not available for PNG export");return}Y.exportCanvasToPNG(s.current,u),E("PNG image downloaded successfully!");break}default:w("Invalid export mode")}}catch(x){w(`Export failed: ${x instanceof Error?x.message:"Unknown error"}`)}finally{p(!1)}},M=()=>{switch(o){case"json":const x=Y.exportToJSON(i,e,t,r,n,u);return JSON.stringify(x,null,2);case"rle":return q.exportToRLE(k);case"png":return"PNG image export (visual representation of current grid)";default:return""}},S=()=>{switch(o){case"json":return".json";case"rle":return".rle";case"png":return".png";default:return""}},R=k.cells.length,N=e*t,g=N>0?(R/N*100).toFixed(1):"0.0";return c.jsxs("div",{className:`pattern-export ${l}`,style:{display:"flex",flexDirection:"column",gap:"16px",padding:"20px",backgroundColor:"#1a1a2a",borderRadius:"12px",border:"1px solid #333344",maxWidth:"700px",width:"100%"},children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c.jsx("h3",{style:{margin:0,color:"#fff",fontSize:"18px"},children:"Export Pattern"}),c.jsx("button",{onClick:a,style:{background:"none",border:"none",color:"#ccc",fontSize:"18px",cursor:"pointer",padding:"4px 8px"},children:"×"})]}),c.jsxs("div",{style:{display:"flex",gap:"16px",padding:"16px",borderRadius:"8px",backgroundColor:"#2a2a3a",border:"1px solid #333344"},children:[c.jsx(me,{pattern:k,size:80}),c.jsxs("div",{style:{color:"#ccc",fontSize:"14px"},children:[c.jsx("div",{style:{marginBottom:"8px"},children:c.jsx("strong",{style:{color:"#fff"},children:"Current Grid"})}),c.jsxs("div",{children:["Size: ",e," × ",t]}),c.jsxs("div",{children:["Living Cells: ",R]}),c.jsxs("div",{children:["Density: ",g,"%"]}),c.jsxs("div",{children:["Generation: ",n]}),c.jsxs("div",{children:["Rule: ",r]})]})]}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[c.jsx("label",{style:{color:"#ccc",fontSize:"14px",fontWeight:"bold"},children:"Pattern Name:"}),c.jsx("input",{type:"text",value:u,onChange:x=>m(x.target.value),placeholder:"Enter pattern name...",style:{padding:"10px 12px",borderRadius:"6px",border:"1px solid #333344",backgroundColor:"#2a2a3a",color:"#fff",fontSize:"14px"}})]}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[c.jsx("label",{style:{color:"#ccc",fontSize:"14px",fontWeight:"bold"},children:"Export Format:"}),c.jsx("div",{style:{display:"flex",gap:"8px"},children:["json","rle","png"].map(x=>c.jsx("button",{onClick:()=>d(x),style:{padding:"8px 16px",border:"1px solid #333344",borderRadius:"6px",backgroundColor:o===x?"#00d4ff":"#2a2a3a",color:o===x?"#000":"#ccc",cursor:"pointer",fontSize:"14px",textTransform:"uppercase"},children:x},x))}),c.jsxs("div",{style:{color:"#888",fontSize:"12px"},children:[o==="json"&&"CellularLab JSON format (can be imported back)",o==="rle"&&"Run Length Encoded format (standard cellular automata format)",o==="png"&&"PNG image of current grid visualization"]})]}),o!=="png"&&c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[c.jsx("label",{style:{color:"#ccc",fontSize:"14px",fontWeight:"bold"},children:"Preview:"}),c.jsx("textarea",{value:M(),readOnly:!0,style:{minHeight:"120px",maxHeight:"200px",padding:"12px",borderRadius:"6px",border:"1px solid #333344",backgroundColor:"#2a2a3a",color:"#ccc",fontSize:"12px",fontFamily:"monospace",resize:"vertical"}})]}),c.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[c.jsxs("div",{style:{color:"#888",fontSize:"12px"},children:["File will be saved as: ",u.replace(/[^a-z0-9\-_]/gi,"_").toLowerCase(),S()]}),c.jsx("button",{onClick:I,disabled:f||!u.trim(),style:{padding:"12px 24px",borderRadius:"6px",border:"none",backgroundColor:f||!u.trim()?"#444":"#00d4ff",color:f||!u.trim()?"#888":"#000",cursor:f||!u.trim()?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold"},children:f?"Exporting...":`Export ${o.toUpperCase()}`})]}),v&&c.jsx("div",{style:{padding:"12px",borderRadius:"6px",backgroundColor:"#1a4a1a",border:"1px solid #33aa33",color:"#aaffaa",fontSize:"14px"},children:v}),j&&c.jsx("div",{style:{padding:"12px",borderRadius:"6px",backgroundColor:"#4a1a1a",border:"1px solid #aa3333",color:"#ffaaaa",fontSize:"14px"},children:j})]})},mr=({onPatternSelect:i,grid:e,gridWidth:t=50,gridHeight:r=50,rule:n="B3/S23",generation:s=0,canvasRef:a,className:l=""})=>{const[o,d]=h.useState(null),[u,m]=h.useState(!1),[f,p]=h.useState(!1),[v,E]=h.useState(""),j=h.useMemo(()=>_.getAllFamousPatterns(),[]),w=h.useMemo(()=>v.trim()?j.filter(R=>R.name.toLowerCase().includes(v.toLowerCase())):j,[j,v]),k=R=>{d(R)},I=()=>{o&&i(o)},M=R=>{if(!o)return;let N;switch(R){case"rotate90":N=_.rotatePattern(o,90);break;case"rotate180":N=_.rotatePattern(o,180);break;case"rotate270":N=_.rotatePattern(o,270);break;case"flipH":N=_.flipPatternHorizontal(o);break;case"flipV":N=_.flipPatternVertical(o);break;default:return}d(N)},S=R=>{i(R)};return c.jsxs("div",{className:`pattern-library ${l}`,children:[u&&c.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 backdrop-blur-sm animate-fade-in",children:c.jsx(ur,{onImport:S,onClose:()=>m(!1)})}),f&&e&&c.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4 backdrop-blur-sm animate-fade-in",children:c.jsx(hr,{grid:e,gridWidth:t,gridHeight:r,rule:n,generation:s,canvasRef:a,onClose:()=>p(!1)})}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[c.jsxs("h3",{className:"text-xl font-bold text-text-primary flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-cell-alive to-primary-400 rounded-full"}),"Pattern Library"]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx("button",{onClick:()=>m(!0),className:"btn-primary flex items-center gap-2 text-sm",children:"Import"}),e&&c.jsx("button",{onClick:()=>p(!0),className:"btn-secondary flex items-center gap-2 text-sm",children:"Export"})]})]}),c.jsx("div",{className:"mb-6",children:c.jsx("input",{type:"text",placeholder:"Search patterns...",value:v,onChange:R=>E(R.target.value),className:"input-field w-full"})}),c.jsxs("div",{className:"flex flex-col gap-4 flex-1 overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center gap-2 text-text-secondary font-semibold",children:[c.jsx("div",{className:"w-2 h-2 bg-cell-alive rounded-full"}),c.jsxs("span",{children:["Famous Patterns (",w.length,")"]})]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 p-2",children:w.map(R=>c.jsx(me,{pattern:R,size:80,selected:o?.name===R.name,onClick:()=>k(R)},R.name))}),w.length===0&&c.jsxs("div",{className:"text-center text-text-tertiary py-12",children:[c.jsx("div",{className:"text-4xl mb-4",children:"🔍"}),c.jsx("p",{className:"text-lg mb-2",children:"No patterns found"}),c.jsxs("p",{className:"text-sm",children:['Try searching for "',v,'"']})]})]}),o&&c.jsx("div",{className:"mt-6 card-elevated p-6 animate-scale-in",children:c.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-start",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(me,{pattern:o,size:120})}),c.jsxs("div",{className:"flex-1 space-y-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"text-xl font-bold text-text-primary mb-2",children:o.name}),c.jsxs("div",{className:"text-sm text-text-secondary space-y-1",children:[c.jsxs("div",{children:["Size: ",o.width," × ",o.height]}),c.jsxs("div",{children:["Cells: ",o.cells.length]}),c.jsxs("div",{children:["Rule: ",o.rule||"B3/S23"]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"text-sm font-semibold text-text-secondary mb-3 flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 bg-warning rounded-full"}),"Transformations"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:()=>M("rotate90"),className:"btn-secondary text-xs px-3 py-1",children:"↻ 90°"}),c.jsx("button",{onClick:()=>M("rotate180"),className:"btn-secondary text-xs px-3 py-1",children:"↻ 180°"}),c.jsx("button",{onClick:()=>M("rotate270"),className:"btn-secondary text-xs px-3 py-1",children:"↻ 270°"}),c.jsx("button",{onClick:()=>M("flipH"),className:"btn-secondary text-xs px-3 py-1",children:"↔ Flip H"}),c.jsx("button",{onClick:()=>M("flipV"),className:"btn-secondary text-xs px-3 py-1",children:"↕ Flip V"})]})]}),c.jsxs("button",{onClick:I,className:"btn-primary flex items-center gap-2",children:[c.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),"Place Pattern"]})]})]})})]})},fr=(i={})=>{const{enableKeyboardShortcuts:e=!0,enableScreenReaderAnnouncements:t=!0,enableFocusManagement:r=!0,reducedMotion:n=!1}=i,s=h.useRef(null),a=h.useRef(null),l=h.useRef(""),{simulation:o,grid:d,rule:u,startSimulation:m,stopSimulation:f,stepSimulation:p,clearGrid:v,setRule:E}=fe(),j=h.useCallback(()=>{const g=n||window.matchMedia("(prefers-reduced-motion: reduce)").matches,x=window.matchMedia("(prefers-contrast: high)").matches||window.matchMedia("(prefers-contrast: more)").matches,P=navigator.userAgent.includes("JAWS")||navigator.userAgent.includes("NVDA")||"speechSynthesis"in window;return{isKeyboardNavigation:document.querySelector(":focus-visible")!==null,isScreenReaderActive:P,hasReducedMotion:g,highContrastMode:x}},[n]),w=h.useCallback((g,x="polite")=>{if(!t||!s.current||l.current===g)return;l.current=g;const P=s.current;P.setAttribute("aria-live",x),P.textContent=g,setTimeout(()=>{P.textContent===g&&(P.textContent="")},1e3)},[t]),k=h.useCallback(g=>{if(!e)return;const x=g.ctrlKey||g.metaKey,P=g.target,A=P.tagName==="INPUT"||P.tagName==="TEXTAREA"||P.isContentEditable;if(!(A&&!x))switch(g.code){case"Space":A||(g.preventDefault(),o.isRunning?(f(),w("Simulation paused")):(m(),w("Simulation started")));break;case"ArrowRight":!A&&x&&(g.preventDefault(),p(),w(`Step completed. Generation ${d.generation+1}`));break;case"KeyR":x&&(g.preventDefault(),v(),w("Grid reset to empty state"));break;case"Escape":g.preventDefault();const D=document.querySelector('[role="dialog"]');if(D){const $=D.querySelector('button[aria-label*="close"], button[data-close]');$ instanceof HTMLElement&&($.click(),w("Modal closed"))}break;case"Tab":r&&document.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])').length>0&&(a.current=g.target);break;case"Digit1":case"Digit2":case"Digit3":case"Digit4":case"Digit5":if(x){g.preventDefault();const $=[{birth:[3],survival:[2,3],notation:"B3/S23"},{birth:[3,6],survival:[2,3],notation:"B36/S23"},{birth:[2],survival:[],notation:"B2/S"},{birth:[3,6,7,8],survival:[3,4,6,7,8],notation:"B3678/S34678"},{birth:[1],survival:[1],notation:"B1/S1"}],ee=parseInt(g.code.slice(-1))-1;if(ee>=0&&ee<$.length){const te=$[ee];te&&(E(te),w(`Rule changed to ${te.notation}`))}}break;case"KeyH":x&&(g.preventDefault(),I());break}},[e,o.isRunning,d.generation,m,f,p,v,E,w,r]),I=h.useCallback(()=>{const x="Keyboard shortcuts: "+["Space: Play/Pause simulation","Ctrl/Cmd + Right Arrow: Step forward","Ctrl/Cmd + R: Reset grid","Ctrl/Cmd + 1-5: Load preset rules","Escape: Close modals","Tab: Navigate focusable elements","Ctrl/Cmd + H: Show this help"].join(", ");w(x,"assertive"),L(x,{duration:5e3,icon:"⌨️"})},[w]),M=h.useCallback((g,x)=>{!r||!g||(requestAnimationFrame(()=>{g.focus(),x&&w(`Focus moved to ${x}`)}),a.current=g)},[r,w]),S=h.useCallback(g=>{if(!r)return()=>{};const x=g.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])'),P=x[0],A=x[x.length-1],D=$=>{$.key==="Tab"&&($.shiftKey?document.activeElement===P&&($.preventDefault(),A.focus()):document.activeElement===A&&($.preventDefault(),P.focus()))};return g.addEventListener("keydown",D),()=>{g.removeEventListener("keydown",D)}},[r]),R=h.useCallback(()=>{if(!t)return null;if(!s.current){const g=document.createElement("div");g.setAttribute("aria-live","polite"),g.setAttribute("aria-atomic","true"),g.setAttribute("aria-relevant","text"),g.style.position="absolute",g.style.left="-10000px",g.style.width="1px",g.style.height="1px",g.style.overflow="hidden",document.body.appendChild(g),s.current=g}return s.current},[t]),N=h.useCallback((g,x)=>{Object.entries(x).forEach(([P,A])=>{g.setAttribute(P,A)})},[]);return h.useEffect(()=>{if(e)return document.addEventListener("keydown",k),()=>document.removeEventListener("keydown",k)},[k,e]),h.useEffect(()=>{const g=R();return()=>{g&&g.parentNode&&(g.parentNode.removeChild(g),s.current=null)}},[R]),h.useEffect(()=>{t&&w(`Cellular automata grid loaded. Size: ${d.width} by ${d.height}. Current rule: ${u.notation}`)},[]),h.useEffect(()=>{if(t&&o.isRunning){const g=setInterval(()=>{w(`Generation ${d.generation}, living cells: ${Array.from(d.current).filter(x=>x===1).length}`)},5e3);return()=>clearInterval(g)}},[o.isRunning,d.generation,d.current,w,t]),{announceToScreenReader:w,manageFocus:M,trapFocus:S,updateAriaProperties:N,showKeyboardShortcuts:I,getAccessibilityState:j,liveRegionRef:s}},J=class J{constructor(){y(this,"options");y(this,"fpsHistory",[]);y(this,"memoryHistory",[]);y(this,"rafId",null);y(this,"isMonitoring",!1);y(this,"onReportCallback");y(this,"warningThresholds");this.options={enableFPSMonitoring:!0,enableMemoryTracking:!0,enableBundleAnalysis:!0,sampleInterval:1e3,maxHistorySize:60},this.warningThresholds={frameRate:60,renderTime:16,memoryUsage:100,startupTime:2e3,targetFPS:60,maxMemoryMB:100,maxLoadTimeMS:2e3,maxBundleSizeMB:5,maxRuleSwitchingMS:50,maxGenerationTimeMS:16},this.setupPerformanceObserver()}static getInstance(){return J.instance||(J.instance=new J),J.instance}setOptions(e){this.options={...this.options,...e}}setReportCallback(e){this.onReportCallback=e}setWarningThresholds(e){this.warningThresholds={...this.warningThresholds,...e}}startMonitoring(){this.isMonitoring||(this.isMonitoring=!0,this.options.enableFPSMonitoring&&this.startFPSMonitoring(),this.options.enableMemoryTracking&&this.startMemoryTracking())}stopMonitoring(){this.isMonitoring&&(this.isMonitoring=!1,this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=null))}startFPSMonitoring(){let e=performance.now(),t=0,r=e;const n=s=>{if(!this.isMonitoring)return;t++;const a=s-r;if(a>=1e3){const l=Math.round(t*1e3/a);this.recordFPS(l),t=0,r=s}this.rafId=requestAnimationFrame(n)};this.rafId=requestAnimationFrame(n)}startMemoryTracking(){const e=()=>{if(!this.isMonitoring)return;const t=this.getMemoryInfo();t&&this.recordMemory(t),setTimeout(e,this.options.sampleInterval)};e()}recordFPS(e){this.fpsHistory.push(e),this.fpsHistory.length>this.options.maxHistorySize&&this.fpsHistory.shift(),e<this.warningThresholds.targetFPS*.8&&this.detectPerformanceDegradation()}recordMemory(e){this.memoryHistory.push(e),this.memoryHistory.length>this.options.maxHistorySize&&this.memoryHistory.shift(),e.usedJSHeapSize/1024/1024>this.warningThresholds.maxMemoryMB&&this.detectMemoryLeak()}getMemoryInfo(){const e=performance.memory;return e?{usedJSHeapSize:e.usedJSHeapSize,totalJSHeapSize:e.totalJSHeapSize,jsHeapSizeLimit:e.jsHeapSizeLimit}:null}detectPerformanceDegradation(){const e=this.fpsHistory.slice(-10),t=e.reduce((r,n)=>r+n,0)/e.length;t<this.warningThresholds.targetFPS*.6?(console.warn(`[PerformanceProfiler] Severe FPS degradation detected: ${t}fps`),this.triggerDegradationWarning("severe","Low FPS detected")):t<this.warningThresholds.targetFPS*.8&&(console.warn(`[PerformanceProfiler] Moderate FPS degradation detected: ${t}fps`),this.triggerDegradationWarning("moderate","FPS below target"))}detectMemoryLeak(){if(this.memoryHistory.length<10)return;const e=this.memoryHistory.slice(-10),t=this.calculateMemoryGrowthRate(e);t>5&&(console.warn(`[PerformanceProfiler] Potential memory leak detected: ${t}MB/min growth`),this.triggerDegradationWarning("moderate","Memory usage growing rapidly"))}calculateMemoryGrowthRate(e){if(e.length<2)return 0;const t=e[0],r=e[e.length-1];if(!t||!r)return 0;const n=t.usedJSHeapSize/1024/1024,s=r.usedJSHeapSize/1024/1024,a=(e.length-1)*(this.options.sampleInterval/1e3/60);return(s-n)/a}triggerDegradationWarning(e,t){const r=this.generateReport();r.degradation.detected=!0,r.degradation.severity=e,r.degradation.causes.push(t),this.onReportCallback&&this.onReportCallback(r)}measureOperationTime(e,t){const r=performance.now(),n=e(),a=performance.now()-r;return console.log(`[PerformanceProfiler] ${t}: ${a.toFixed(2)}ms`),t.includes("rule switching")&&a>this.warningThresholds.maxRuleSwitchingMS&&console.warn(`[PerformanceProfiler] Slow rule switching: ${a.toFixed(2)}ms`),t.includes("generation")&&a>this.warningThresholds.maxGenerationTimeMS&&console.warn(`[PerformanceProfiler] Slow generation computation: ${a.toFixed(2)}ms`),n}async measureAsyncOperation(e,t){const r=performance.now(),n=await e(),a=performance.now()-r;return console.log(`[PerformanceProfiler] ${t}: ${a.toFixed(2)}ms`),n}generateReport(){const e=this.getMemoryInfo()||{usedJSHeapSize:0,totalJSHeapSize:0,jsHeapSizeLimit:0},t=this.calculateFPSMetrics(),r=this.calculateMemoryMetrics(e),n=this.getLoadTimeMetrics(),s=this.estimateBundleSize();return{fps:t,memory:r,loadTime:n,bundleSize:s,degradation:{detected:!1,severity:"none",causes:[],recommendations:this.generateRecommendations(t,r)},timestamp:new Date}}calculateFPSMetrics(){if(this.fpsHistory.length===0)return{current:0,average:0,min:0,max:0,history:[]};const e=this.fpsHistory[this.fpsHistory.length-1]||0,t=this.fpsHistory.reduce((s,a)=>s+a,0)/this.fpsHistory.length,r=Math.min(...this.fpsHistory),n=Math.max(...this.fpsHistory);return{current:e,average:Math.round(t),min:r,max:n,history:[...this.fpsHistory]}}calculateMemoryMetrics(e){const t=this.memoryHistory.reduce((s,a)=>a.usedJSHeapSize>s.usedJSHeapSize?a:s,e),r=this.memoryHistory.length>1?this.calculateMemoryGrowthRate(this.memoryHistory):0,n=r>2;return{current:e,peak:t,leaked:n,growthRate:r,history:[...this.memoryHistory]}}getLoadTimeMetrics(){try{const t=(performance.getEntriesByType?performance.getEntriesByType("navigation"):[])[0];return t?{initial:t.loadEventEnd-t.fetchStart,interactive:t.domInteractive-t.fetchStart,complete:t.loadEventEnd-t.fetchStart}:{initial:0,interactive:0,complete:0}}catch{return{initial:0,interactive:0,complete:0}}}estimateBundleSize(){const e=performance.getEntriesByType("resource");let t=0;const r={};return e.forEach(n=>{if(n.name.includes(".js")||n.name.includes(".css")){const s=n.transferSize||n.encodedBodySize||0;t+=s;const a=n.name.split("/").pop()||"unknown";r[a]=s}}),{total:t,chunks:r,estimated:!0}}generateRecommendations(e,t){const r=[];return e.average<this.warningThresholds.targetFPS*.8&&(r.push("Consider reducing grid size for better performance"),r.push("Enable performance mode in settings")),t.current.usedJSHeapSize/1024/1024>this.warningThresholds.maxMemoryMB&&(r.push("Clear grid history to free memory"),r.push("Avoid running simulations for extended periods")),t.leaked&&(r.push("Refresh the page to clear memory leaks"),r.push("Report persistent memory issues")),r}runBenchmarks(){const e=[],t=this.generateReport();e.push({name:"Average FPS",target:this.warningThresholds.targetFPS,current:t.fps.average,status:t.fps.average>=this.warningThresholds.targetFPS?"pass":t.fps.average>=this.warningThresholds.targetFPS*.8?"warning":"fail",impact:"high"});const r=t.memory.current.usedJSHeapSize/1024/1024;e.push({name:"Memory Usage (MB)",target:this.warningThresholds.maxMemoryMB,current:Math.round(r),status:r<=this.warningThresholds.maxMemoryMB?"pass":r<=this.warningThresholds.maxMemoryMB*1.2?"warning":"fail",impact:"medium"}),e.push({name:"Initial Load Time (ms)",target:this.warningThresholds.maxLoadTimeMS,current:Math.round(t.loadTime.initial),status:t.loadTime.initial<=this.warningThresholds.maxLoadTimeMS?"pass":t.loadTime.initial<=this.warningThresholds.maxLoadTimeMS*1.2?"warning":"fail",impact:"medium"});const n=t.bundleSize.total/1024/1024;return e.push({name:"Bundle Size (MB)",target:this.warningThresholds.maxBundleSizeMB,current:Math.round(n*100)/100,status:n<=this.warningThresholds.maxBundleSizeMB?"pass":n<=this.warningThresholds.maxBundleSizeMB*1.1?"warning":"fail",impact:"low"}),e}setupPerformanceObserver(){if("PerformanceObserver"in window)try{new PerformanceObserver(t=>{t.getEntries().forEach(n=>{n.entryType==="measure"&&console.log(`[PerformanceProfiler] ${n.name}: ${n.duration.toFixed(2)}ms`)})}).observe({entryTypes:["measure","navigation","paint"]})}catch{console.warn("[PerformanceProfiler] PerformanceObserver not fully supported")}}markStart(e){performance.mark(`${e}-start`)}markEnd(e){performance.mark(`${e}-end`);try{performance.measure(e,`${e}-start`,`${e}-end`)}catch{console.warn(`[PerformanceProfiler] Failed to measure ${e}`)}}clearMarks(e){e?(performance.clearMarks(`${e}-start`),performance.clearMarks(`${e}-end`),performance.clearMeasures(e)):(performance.clearMarks(),performance.clearMeasures())}getDetailedReport(){const e=this.generateReport(),t=this.runBenchmarks();return`
# Performance Report - ${e.timestamp.toLocaleString()}

## FPS Metrics
- Current: ${e.fps.current} fps
- Average: ${e.fps.average} fps
- Min: ${e.fps.min} fps
- Max: ${e.fps.max} fps

## Memory Usage
- Current: ${Math.round(e.memory.current.usedJSHeapSize/1024/1024)}MB
- Peak: ${Math.round(e.memory.peak.usedJSHeapSize/1024/1024)}MB
- Growth Rate: ${e.memory.growthRate.toFixed(2)}MB/min
- Memory Leak: ${e.memory.leaked?"Detected":"None"}

## Load Performance
- Initial Load: ${Math.round(e.loadTime.initial)}ms
- Interactive: ${Math.round(e.loadTime.interactive)}ms
- Complete: ${Math.round(e.loadTime.complete)}ms

## Bundle Analysis
- Total Size: ${Math.round(e.bundleSize.total/1024/1024*100)/100}MB
- Main Chunks: ${Object.entries(e.bundleSize.chunks).map(([r,n])=>`${r}: ${Math.round(n/1024)}KB`).join(", ")}

## Benchmarks
${t.map(r=>`- ${r.name}: ${r.current}/${r.target} - ${r.status.toUpperCase()}`).join(`
`)}

## Recommendations
${e.degradation.recommendations.map(r=>`- ${r}`).join(`
`)}
`}};y(J,"instance");let we=J;const H=we.getInstance();var Fe=(i=>(i.LOW="low",i.MEDIUM="medium",i.HIGH="high",i.CRITICAL="critical",i))(Fe||{});class ze extends Error{constructor(t,r,n="medium",s=void 0,a=!0){super(r);y(this,"code");y(this,"severity");y(this,"context");y(this,"recoverable");this.name="CellularLabError",this.code=t,this.severity=n,this.context=s,this.recoverable=a}}const X=class X{constructor(){y(this,"errorLog",[]);y(this,"maxLogSize",100);y(this,"onErrorCallback")}static getInstance(){return X.instance||(X.instance=new X),X.instance}setErrorCallback(e){this.onErrorCallback=e}getSystemInfo(){return{browserInfo:navigator.userAgent,timestamp:new Date,userAgent:navigator.userAgent}}createErrorInfo(e,t){if(e instanceof ze)return{code:e.code,message:e.message,severity:e.severity,context:{...this.getSystemInfo(),...e.context||{},...t||{}},recoverable:e.recoverable,userMessage:this.getUserMessage(e.code,e.message),recoveryActions:this.getRecoveryActions(e.code)};const r=this.classifyError(e),n=this.determineSeverity(r,e);return{code:r,message:e.message,severity:n,context:{...this.getSystemInfo(),...t||{},stackTrace:e.stack||"No stack trace available"},recoverable:this.isRecoverable(r),userMessage:this.getUserMessage(r,e.message),recoveryActions:this.getRecoveryActions(r)}}classifyError(e){const t=e.message.toLowerCase(),r=e.stack?.toLowerCase()||"";return t.includes("canvas")||t.includes("2d")||t.includes("webgl")?"CANVAS_NOT_SUPPORTED":t.includes("memory")||t.includes("heap")?"MEMORY_EXCEEDED":t.includes("fetch")||t.includes("network")?"NETWORK_ERROR":t.includes("rle")||t.includes("pattern")?"PATTERN_IMPORT_FAILED":t.includes("rule")||t.includes("notation")?"INVALID_RULE_FORMAT":t.includes("grid")&&t.includes("size")?"GRID_SIZE_INVALID":r.includes("gridrenderer")||r.includes("rendering")?"RENDERING_FAILED":r.includes("ruleengine")||r.includes("simulation")?"SIMULATION_ERROR":"UNKNOWN_ERROR"}determineSeverity(e,t){switch(e){case"CANVAS_NOT_SUPPORTED":case"MEMORY_EXCEEDED":return"critical";case"RENDERING_FAILED":case"SIMULATION_ERROR":return"high";case"PATTERN_IMPORT_FAILED":case"INVALID_RULE_FORMAT":case"GRID_SIZE_INVALID":return"medium";case"NETWORK_ERROR":return"low";default:return"medium"}}isRecoverable(e){return!["CANVAS_NOT_SUPPORTED"].includes(e)}getUserMessage(e,t){return{CANVAS_NOT_SUPPORTED:"Your browser does not support HTML5 Canvas, which is required for this application. Please use a modern browser like Chrome, Firefox, Safari, or Edge.",MEMORY_EXCEEDED:"The application has run out of memory. Try reducing the grid size or refreshing the page.",PATTERN_IMPORT_FAILED:"Failed to import the pattern. Please check that the file format is correct (RLE or JSON).",INVALID_RULE_FORMAT:'The rule format is invalid. Please use the format "B3/S23" where numbers represent neighbor counts.',GRID_SIZE_INVALID:"The grid size is too large or invalid. Please choose a size between 20x20 and 200x200.",RENDERING_FAILED:"Failed to render the grid. This may be due to browser limitations or memory constraints.",SIMULATION_ERROR:"An error occurred during simulation. The simulation has been paused.",NETWORK_ERROR:"Network connection failed. Some features may not work properly.",UNKNOWN_ERROR:"An unexpected error occurred. Please try refreshing the page."}[e]||`An error occurred: ${t}`}getRecoveryActions(e){return{CANVAS_NOT_SUPPORTED:["Update your browser to the latest version","Try a different browser (Chrome, Firefox, Safari, Edge)","Enable hardware acceleration in browser settings"],MEMORY_EXCEEDED:["Reduce grid size to 100x100 or smaller","Close other browser tabs","Refresh the page to clear memory","Restart your browser"],PATTERN_IMPORT_FAILED:["Check file format (should be .rle or .json)","Verify file is not corrupted","Try a smaller pattern","Use manual pattern creation instead"],INVALID_RULE_FORMAT:['Use format B[numbers]/S[numbers] (e.g., "B3/S23")',"Check for typos in the rule","Try a preset rule instead","Refer to rule documentation"],GRID_SIZE_INVALID:["Choose size between 20x20 and 200x200","Use preset sizes","Clear browser cache if size persists","Refresh the page"],RENDERING_FAILED:["Reduce grid size","Close other applications using graphics","Update graphics drivers","Try refreshing the page"],SIMULATION_ERROR:["Reset the grid","Try a different rule","Reduce simulation speed","Refresh the page"],NETWORK_ERROR:["Check internet connection","Try again in a few moments","Use offline features only","Contact support if persistent"],UNKNOWN_ERROR:["Refresh the page","Clear browser cache","Try in a different browser","Report the issue if it persists"]}[e]||["Refresh the page","Try again","Contact support if the issue persists"]}handle(e,t){const r=this.createErrorInfo(e,t);return this.logError(r),this.notifyUser(r),this.onErrorCallback&&this.onErrorCallback(r),r}logError(e){console.error(`[CellularLab] ${e.code}: ${e.message}`,e.context),this.errorLog.unshift(e),this.errorLog.length>this.maxLogSize&&(this.errorLog=this.errorLog.slice(0,this.maxLogSize))}notifyUser(e){const t=this.getToastDuration(e.severity),r=this.getErrorIcon(e.severity);L.error(e.userMessage,{duration:t,icon:r,style:{maxWidth:"400px"}}),e.severity==="critical"&&this.showCriticalErrorModal(e)}getToastDuration(e){switch(e){case"low":return 3e3;case"medium":return 5e3;case"high":return 8e3;case"critical":return 0;default:return 5e3}}getErrorIcon(e){switch(e){case"low":return"⚠️";case"medium":return"❗";case"high":return"🚨";case"critical":return"💥";default:return"❗"}}showCriticalErrorModal(e){const t=document.createElement("div");t.className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.setAttribute("aria-labelledby","error-title"),t.innerHTML=`
      <div class="bg-white dark:bg-gray-800 p-6 rounded-lg max-w-md mx-4 shadow-xl">
        <h2 id="error-title" class="text-xl font-bold text-red-600 dark:text-red-400 mb-4">
          Critical Error
        </h2>
        <p class="text-gray-700 dark:text-gray-300 mb-4">
          ${e.userMessage}
        </p>
        <div class="mb-4">
          <h3 class="font-semibold text-gray-900 dark:text-gray-100 mb-2">
            Try these solutions:
          </h3>
          <ul class="list-disc list-inside text-sm text-gray-600 dark:text-gray-400 space-y-1">
            ${e.recoveryActions?.map(s=>`<li>${s}</li>`).join("")||""}
          </ul>
        </div>
        <div class="flex gap-2">
          <button id="error-close" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors">
            Close
          </button>
          <button id="error-refresh" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors">
            Refresh Page
          </button>
        </div>
      </div>
    `;const r=t.querySelector("#error-close"),n=t.querySelector("#error-refresh");r?.addEventListener("click",()=>{document.body.removeChild(t)}),n?.addEventListener("click",()=>{window.location.reload()}),document.body.appendChild(t),requestAnimationFrame(()=>{t.querySelector("button")?.focus()})}getErrorLog(){return[...this.errorLog]}clearErrorLog(){this.errorLog=[]}createCanvasNotSupportedFallback(){const e=document.createElement("div");return e.className="flex flex-col items-center justify-center min-h-[400px] p-8 text-center bg-gray-50 dark:bg-gray-900 border-2 border-gray-200 dark:border-gray-700 rounded-lg",e.innerHTML=`
      <div class="text-6xl mb-4">🖥️</div>
      <h2 class="text-2xl font-bold text-gray-900 dark:text-gray-100 mb-4">
        Canvas Not Supported
      </h2>
      <p class="text-gray-600 dark:text-gray-400 mb-6 max-w-md">
        Your browser doesn't support HTML5 Canvas, which is required for this cellular automata simulator.
      </p>
      <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-600 mb-6">
        <h3 class="font-semibold text-gray-900 dark:text-gray-100 mb-2">
          Recommended Browsers:
        </h3>
        <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
          <li>• Chrome 80 or later</li>
          <li>• Firefox 75 or later</li>
          <li>• Safari 13 or later</li>
          <li>• Edge 80 or later</li>
        </ul>
      </div>
      <button onclick="window.location.reload()" class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
        Try Again
      </button>
    `,e}checkBrowserSupport(){const e=[];return document.createElement("canvas").getContext||e.push("HTML5 Canvas"),window.localStorage||e.push("Local Storage"),(!window.CSS||!window.CSS.supports||!window.CSS.supports("display","grid"))&&e.push("CSS Grid"),(!window.CSS||!window.CSS.supports||!window.CSS.supports("--custom-property","value"))&&e.push("CSS Custom Properties"),Array.from||e.push("ES2015 Array.from"),Promise||e.push("ES2015 Promises"),{isSupported:e.length===0,missingFeatures:e}}};y(X,"instance");let Se=X;const Re=Se.getInstance(),O=(i,e)=>Re.handle(i,e),pr=(i,e,t="medium",r,n=!0)=>new ze(i,e,t,r,n);function gr(){const i=h.useRef(null),e=h.useRef(null),[t,r]=h.useState(""),[n,s]=h.useState(""),a=de.getAllPresetRules(),{grid:l,simulation:o,rule:d,startSimulation:u,stopSimulation:m,stepSimulation:f,clearGrid:p,randomizeGrid:v,centerPattern:E,setPatternPlacementMode:j,setGridSize:w,setSpeed:k,setRule:I}=fe(),{announceToScreenReader:M,getAccessibilityState:S}=fr({enableKeyboardShortcuts:!0,enableScreenReaderAnnouncements:!0,enableFocusManagement:!0});h.useEffect(()=>(H.startMonitoring(),H.setWarningThresholds({targetFPS:60,maxMemoryMB:100,maxLoadTimeMS:2e3,maxBundleSizeMB:5,maxRuleSwitchingMS:50,maxGenerationTimeMS:16}),()=>{H.stopMonitoring()}),[]),h.useEffect(()=>{const b=Re.checkBrowserSupport();if(!b.isSupported&&(console.error("Browser support issues:",b.missingFeatures),b.missingFeatures.includes("HTML5 Canvas"))){const C=Re.createCanvasNotSupportedFallback(),T=document.querySelector('[data-testid="grid-container"]');T&&T.parentNode&&T.parentNode.replaceChild(C,T)}},[]);const R=S(),N=h.useCallback(()=>{const b=o.isRunning?"pause":"start";try{H.measureOperationTime(()=>{o.isRunning?m():u()},"simulation toggle");const C=o.isRunning?"Simulation paused":"Simulation started";F.success(C),M(C)}catch(C){const T=O(C,{component:"App",operation:`simulation ${b}`});console.error("Simulation toggle failed:",T)}},[o.isRunning,u,m,M]),g=h.useCallback(()=>{try{H.measureOperationTime(()=>{f()},"generation computation");const b=`Generation ${l.generation+1}`;F.success(b),M(`Step completed. ${b}`)}catch(b){const C=O(b,{component:"App",operation:"step simulation"});console.error("Step simulation failed:",C)}},[f,l.generation,M]),x=h.useCallback(()=>{try{o.isRunning&&m(),H.measureOperationTime(()=>{p()},"grid reset");const b="Grid cleared";F.success(b),M(b)}catch(b){const C=O(b,{component:"App",operation:"reset grid"});console.error("Grid reset failed:",C)}},[o.isRunning,m,p,M]),P=h.useCallback(()=>{try{o.isRunning&&m(),H.measureOperationTime(()=>{v()},"grid randomization");const b="Grid randomized";F.success(b),M(b)}catch(b){const C=O(b,{component:"App",operation:"randomize grid"});console.error("Grid randomization failed:",C)}},[o.isRunning,m,v,M]),A=h.useCallback(b=>{try{const C=E(b);if(C.success){const T=`${b.name} placed on grid`;F.success(T),M(T),j(!1)}else{const T=pr("PATTERN_PLACEMENT_FAILED",C.error||"Failed to place pattern",Fe.MEDIUM);O(T,{component:"App",operation:"pattern placement"})}}catch(C){const T=O(C,{component:"App",operation:"pattern placement"});console.error("Pattern placement failed:",T)}},[E,j,M]),D=h.useCallback(()=>{const b=parseInt(t,10),C=parseInt(n,10);if(isNaN(b)||isNaN(C)){F.error("Please enter valid numbers for width and height");return}if(b<20||b>200||C<20||C>200){F.error("Grid size must be between 20 and 200");return}try{w(b,C);const T=`Grid resized to ${b}×${C}`;F.success(T),M(T),r(""),s("")}catch(T){const K=O(T,{component:"App",operation:"grid resize"});console.error("Grid resize failed:",K)}},[t,n,w,M]),$=h.useCallback(b=>{try{const T=Math.round(200/b);k(T);const K=`Speed set to ${b}x (${T}ms)`;F.success(K),M(K)}catch(C){const T=O(C,{component:"App",operation:"speed change"});console.error("Speed change failed:",T)}},[k,M]),ee=h.useCallback(b=>{try{const C=a.find(K=>K.id===b);if(!C){F.error("Invalid rule selected");return}I({birth:C.birth,survival:C.survival,notation:C.notation});const T=`Rule changed to ${C.name} (${C.notation})`;F.success(T),M(T)}catch(C){const T=O(C,{component:"App",operation:"rule change"});console.error("Rule change failed:",T)}},[a,I,M]),te=["min-h-screen bg-background text-text-primary",R.highContrastMode&&"high-contrast",R.hasReducedMotion&&"reduce-motion"].filter(Boolean).join(" ");return c.jsxs("div",{ref:e,className:te,"data-testid":"app-root",children:[c.jsxs("div",{className:"container mx-auto px-10 py-6 max-w-full",children:[c.jsxs("header",{className:"text-center mb-8 animate-slide-up",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h1",{className:"text-4xl md:text-5xl font-bold bg-gradient-to-r from-cell-alive to-primary-400 bg-clip-text text-transparent mb-3 animate-float",children:"CellularLab"}),c.jsx("p",{className:"text-lg text-text-secondary max-w-2xl mx-auto",children:"Interactive Cellular Automata Explorer"}),c.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-cell-alive to-primary-400 mx-auto mt-4 rounded-full"})]}),c.jsxs("div",{className:"sr-only",children:["Current rule: ",d.notation,". Grid size: ",l.width," by ",l.height,". Generation: ",l.generation,". Press Ctrl+H for keyboard shortcuts."]})]}),c.jsxs("main",{role:"main",className:"space-y-8",children:[c.jsx("section",{"aria-labelledby":"grid-heading",children:c.jsxs("div",{className:"card p-8 animate-slide-in-from-left",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4",children:[c.jsxs("div",{children:[c.jsxs("h2",{id:"grid-heading",className:"text-3xl font-bold text-text-primary mb-2",children:["Grid (",l.width,"×",l.height,")"]}),c.jsx("div",{className:"flex items-center gap-4 text-sm text-text-secondary",children:c.jsxs("div",{className:"flex items-center gap-2","data-testid":"generation","aria-live":"polite","aria-atomic":"true",children:[c.jsx("div",{className:"w-2 h-2 bg-cell-alive rounded-full animate-pulse"}),"Generation: ",c.jsx("span",{className:"font-mono text-text-accent font-semibold",children:l.generation})]})})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:N,className:`btn-${o.isRunning?"warning":"primary"} flex items-center gap-2 text-sm`,"aria-pressed":o.isRunning,"aria-label":o.isRunning?"Pause simulation":"Start simulation","data-testid":"play-pause-button",children:[o.isRunning?c.jsx(at,{size:16}):c.jsx(lt,{size:16}),o.isRunning?"Pause":"Play"]}),c.jsxs("button",{onClick:g,disabled:o.isRunning,className:"btn-secondary flex items-center gap-2 text-sm disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:hover:scale-100","aria-label":"Step simulation forward one generation","aria-describedby":o.isRunning?"step-disabled-help":void 0,"data-testid":"step-button",children:[c.jsx(gt,{size:16}),"Step"]}),c.jsxs("button",{onClick:x,className:"btn-danger flex items-center gap-2 text-sm","aria-label":"Reset grid to empty state","data-testid":"reset-button",children:[c.jsx(dt,{size:16}),"Reset"]}),c.jsxs("button",{onClick:P,className:"btn-secondary flex items-center gap-2 text-sm","aria-label":"Randomize grid with 50% probability for each cell","data-testid":"randomize-button",children:[c.jsx(ft,{size:16}),"Random"]})]}),o.isRunning&&c.jsx("div",{id:"step-disabled-help",className:"sr-only",children:"Step button is disabled while simulation is running"})]}),c.jsx(dr,{canvasRef:i,"aria-label":`Cellular automata grid, ${l.width} by ${l.height} cells, generation ${l.generation}`})]})}),c.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 animate-slide-in-from-right","aria-label":"Simulation controls and information",children:[c.jsxs("div",{className:"card p-6","aria-labelledby":"rule-heading",children:[c.jsxs("h3",{id:"rule-heading",className:"text-lg font-semibold mb-4 text-text-primary flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-cell-alive to-primary-400 rounded-full"}),"Current Rule"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"text-center bg-surface-elevated rounded-xl p-3 border border-grid-line/20",children:[c.jsx("div",{className:"text-2xl font-mono font-bold text-transparent bg-gradient-to-r from-cell-alive to-primary-400 bg-clip-text mb-1","aria-label":`Current rule: ${d.notation}`,children:d.notation}),c.jsx("div",{className:"text-xs text-text-secondary",children:a.find(b=>b.notation===d.notation)?.name||"Custom Rule"})]}),c.jsx("div",{className:"grid grid-cols-2 gap-2",children:a.map(b=>c.jsx("button",{onClick:()=>ee(b.id),className:`px-3 py-2 text-sm rounded-lg border transition-colors ${d.notation===b.notation?"bg-cell-alive text-black border-cell-alive font-semibold":"bg-surface-elevated border-grid-line/20 text-text-secondary hover:border-cell-alive hover:text-cell-alive"}`,"aria-label":`Set rule to ${b.name} (${b.notation})`,"data-testid":`rule-${b.id}`,children:b.name},b.id))})]})]}),c.jsxs("div",{className:"card p-6","aria-labelledby":"speed-heading",children:[c.jsxs("h3",{id:"speed-heading",className:"text-lg font-semibold mb-4 text-text-primary flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-warning to-warning/60 rounded-full"}),"Simulation Speed"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"text-center bg-surface-elevated rounded-xl p-3 border border-grid-line/20",children:[c.jsxs("div",{className:"text-xl font-mono font-bold text-warning mb-1","aria-label":`Current speed: ${o.speed} milliseconds per generation`,children:[o.speed,"ms"]}),c.jsx("div",{className:"text-xs text-text-secondary",children:"per generation"})]}),c.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[c.jsx("button",{onClick:()=>$(.5),className:`px-3 py-2 text-sm rounded-lg border transition-colors ${o.speed===400?"bg-warning text-black border-warning font-semibold":"bg-surface-elevated border-grid-line/20 text-text-secondary hover:border-warning hover:text-warning"}`,"aria-label":"Set speed to 0.5x (slower)","data-testid":"speed-0.5x",children:"0.5x"}),c.jsx("button",{onClick:()=>$(1),className:`px-3 py-2 text-sm rounded-lg border transition-colors ${o.speed===200?"bg-warning text-black border-warning font-semibold":"bg-surface-elevated border-grid-line/20 text-text-secondary hover:border-warning hover:text-warning"}`,"aria-label":"Set speed to 1x (normal)","data-testid":"speed-1x",children:"1x"}),c.jsx("button",{onClick:()=>$(2),className:`px-3 py-2 text-sm rounded-lg border transition-colors ${o.speed===100?"bg-warning text-black border-warning font-semibold":"bg-surface-elevated border-grid-line/20 text-text-secondary hover:border-warning hover:text-warning"}`,"aria-label":"Set speed to 2x (faster)","data-testid":"speed-2x",children:"2x"}),c.jsx("button",{onClick:()=>$(4),className:`px-3 py-2 text-sm rounded-lg border transition-colors ${o.speed===50?"bg-warning text-black border-warning font-semibold":"bg-surface-elevated border-grid-line/20 text-text-secondary hover:border-warning hover:text-warning"}`,"aria-label":"Set speed to 4x (fastest)","data-testid":"speed-4x",children:"4x"})]})]})]}),c.jsxs("div",{className:"card p-6","aria-labelledby":"resize-heading",children:[c.jsxs("h3",{id:"resize-heading",className:"text-lg font-semibold mb-4 text-text-primary flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-info to-info/60 rounded-full"}),"Grid Size"]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{htmlFor:"grid-width",className:"block text-xs text-text-secondary mb-1",children:"Width (20-200)"}),c.jsx("input",{id:"grid-width",type:"text",value:t,onChange:b=>r(b.target.value),placeholder:l.width.toString(),className:"w-full px-3 py-2 text-sm bg-surface-elevated border border-grid-line/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-transparent"})]}),c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{htmlFor:"grid-height",className:"block text-xs text-text-secondary mb-1",children:"Height (20-200)"}),c.jsx("input",{id:"grid-height",type:"text",value:n,onChange:b=>s(b.target.value),placeholder:l.height.toString(),className:"w-full px-3 py-2 text-sm bg-surface-elevated border border-grid-line/20 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-400 focus:border-transparent"})]})]}),c.jsxs("button",{onClick:D,className:"btn-secondary w-full flex items-center justify-center gap-2","aria-label":"Resize grid to specified dimensions",children:[c.jsx(ht,{size:16}),"Resize Grid"]})]})]})]})]}),c.jsx("section",{className:"mt-12 animate-slide-in-from-bottom","aria-labelledby":"patterns-heading",children:c.jsxs("div",{className:"card-elevated p-8",children:[c.jsx("div",{className:"flex items-center justify-center mb-6",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-cell-alive to-primary-400 rounded-full animate-pulse"}),c.jsx("h2",{id:"patterns-heading",className:"text-2xl font-bold text-text-primary",children:"Pattern Library"}),c.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-primary-400 to-cell-alive rounded-full animate-pulse"})]})}),c.jsx(mr,{onPatternSelect:A,grid:l.current,gridWidth:l.width,gridHeight:l.height,rule:d.notation,generation:l.generation,canvasRef:i})]})})]}),!1]})}const Oe=document.getElementById("root");if(!Oe)throw new Error("Root element not found");Ke.createRoot(Oe).render(c.jsxs(Xe.StrictMode,{children:[c.jsx(gr,{}),c.jsx(ar,{position:"top-right",toastOptions:{duration:3e3,style:{background:"#1e1e2f",color:"#ffffff",border:"1px solid #333344"}}})]}));
